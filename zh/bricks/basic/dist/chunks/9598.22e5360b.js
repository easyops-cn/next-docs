/*! For license information please see 9598.22e5360b.js.LICENSE.txt */
"use strict";(self.webpackChunk_next_bricks_basic=self.webpackChunk_next_bricks_basic||[]).push([[9598],{4795:(e,t,r)=>{function n(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(o,a){var i=e.apply(t,r);function s(e){n(i,o,a,s,c,"next",e)}function c(e){n(i,o,a,s,c,"throw",e)}s(void 0)}))}}r.d(t,{Z:()=>o})},6171:(e,t,r)=>{function n(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}r.d(t,{Z:()=>n})},5866:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(5863);function o(e,t){(0,n.Z)(e,t),t.add(e)}},6666:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(5850);function o(e,t,r){return(t=(0,n.Z)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},3028:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(6666);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},2159:(e,t,r)=>{function n(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}r.d(t,{Z:()=>n})},5850:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(6522);function o(e){var t=function(e,t){if("object"!==(0,n.Z)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==(0,n.Z)(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===(0,n.Z)(t)?t:String(t)}},9598:(e,t,r)=>{r.r(t),r.d(t,{Dialog:()=>Rt,Notification:()=>jt,StoryboardFunctionRegistryFactory:()=>z,__secret_internals:()=>n,applyTheme:()=>L,authenticate:()=>ca,batchSetAppsLocalTheme:()=>N,checkIfByTransform:()=>Je,checkIfOfComputed:()=>Ge,createHistory:()=>be,createRuntime:()=>ao,customProcessors:()=>y,customTemplates:()=>ct,fetchByProvider:()=>da,getAuth:()=>la,getBasePath:()=>W,getCssPropertyValue:()=>D,getCurrentMode:()=>$,getCurrentTheme:()=>B,getHistory:()=>we,getPageInfo:()=>an,getRuntime:()=>io,handleHttpError:()=>Ut,httpErrorToString:()=>Mt,isLoggedIn:()=>pa,isUnauthenticatedError:()=>xt,logout:()=>ua,matchPath:()=>bt,registerWidgetFunctions:()=>yo,registerWidgetI18n:()=>E,unstable_createRoot:()=>va});var n={};r.r(n),r.d(n,{legacyDoTransform:()=>ba,mountUseBrick:()=>ga,renderUseBrick:()=>ha,unmountUseBrick:()=>ya,updateSnippetPreviewSettings:()=>Ia,updateStoryboard:()=>wa,updateStoryboardByRoute:()=>Sa,updateStoryboardBySnippet:()=>Za,updateStoryboardByTemplate:()=>Ea,updateTemplatePreviewSettings:()=>ka});var o=r(3028),a=r(4795),i=r(5178),s=r(2236),c=r(4167),l=function(){var e=(0,a.Z)((function*(e,t){return(yield c.http.post("api/gateway/micro_app.permission.ValidatePermissions/api/micro_app/v1/permission/validate",e,t)).data}));return function(t,r){return e.apply(this,arguments)}}(),u=r(9530),p=r(9026),d=r(6821),f=r(1337),v=r(8817),h=r(3395),m=r(687),g=new WeakMap,y=new class{constructor(){(0,h.Z)(this,g,{writable:!0,value:new Map})}define(e,t){var[r,n]=e.split("."),o=(0,m.Z)(this,g).get(r);if(o||(o=new Map,(0,m.Z)(this,g).set(r,o)),o.has(n))throw new Error('Custom processor of "'.concat(e,'" already registered'));o.set(n,t)}get(e){return(0,m.Z)(this,g).get(e)}},b=r(5966);function w(e){var{app:t,meta:r}=e;if(null!=r&&r.i18n){var n=S("app",t.id),o=[];return Object.entries(r.i18n).forEach((e=>{var[t,r]=e;b.i18n.addResourceBundle(t,n,r),o.push(t)})),()=>{for(var e of o)b.i18n.removeResourceBundle(e,n)}}}function S(e,t){return"".concat(e,"/").concat(t)}function E(e,t){var r=S("widget",e);Object.entries(t).forEach((e=>{var[t,n]=e;b.i18n.addResourceBundle(t,r,n)}))}function k(e){return b.i18n.getFixedT(null,S("widget",e))}function Z(e,t){return{get(r){var n;return"".concat(null!==(n=window.PUBLIC_ROOT)&&void 0!==n?n:"","bricks/").concat(e,"/").concat(window.PUBLIC_ROOT_WITH_VERSION&&t?"".concat(t,"/"):"","dist/assets/").concat(r)}}}function I(){return window.__BRICK_NEXT_DEVTOOLS_HOOK__}var A=()=>{throw new Error("Can't modify read-only proxy object")},O={set:A,defineProperty:A,deleteProperty:A,setPrototypeOf:A};function T(e){return new Proxy(e,O)}function P(e){var{get:t,ownKeys:r}=e;return I()?T(Object.fromEntries(r(null).map((e=>[e,t(null,e,null)])))):new Proxy(Object.freeze({}),{get:t})}var _="light",C=new p.JsonStorage(localStorage),R="apps-theme";function M(e){if("dark"!==e&&"light"!==e&&"dark-v2"!==e)throw new Error("Unsupported theme: ".concat(e));_=e}function x(){return _}function B(){return document.documentElement.dataset.theme}function L(e){e?M(e):e=x(),e!==B()&&(document.documentElement.dataset.theme=e,window.dispatchEvent(new CustomEvent("theme.change",{detail:e})))}function N(e){C.setItem(R,(0,o.Z)((0,o.Z)({},U()),e))}function U(){var e,t;try{t=C.getItem(R)}catch(e){console.error("JSON parse error inside `getLocalAppsTheme()`")}return null!==(e=t)&&void 0!==e?e:{}}var j="default";function F(e){if("dashboard"!==e&&"default"!==e)throw new Error("Unsupported mode: ".concat(e));j=e}function $(){return document.documentElement.dataset.mode}function K(e){e?F(e):e=j,e!==$()&&(document.documentElement.dataset.mode=e,window.dispatchEvent(new CustomEvent("mode.change",{detail:e})))}function D(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.documentElement;return r&&(null===(t=window.getComputedStyle(r))||void 0===t?void 0:t.getPropertyValue(e))||""}function W(){var e=document.querySelector("base");return e?e.getAttribute("href"):"/"}function V(e,t){var r={};for(var n of e){var o=H(n,t);void 0!==o&&(r[n]=o)}return r}function H(e,t){var r,n,{collectCoverage:o,widgetId:a,widgetVersion:s,app:c,appendI18nNamespace:l,storyboardFunctions:u,isStoryboardFunction:p}=t;switch(e){case"BASE_URL":return o?"/next":W().replace(/\/$/,"");case"FN":return u;case"IMG":return o?{get:e=>"mock/images/".concat(e)}:a?Z(a,s):(r=c.id,n=c.isBuildPush,{get:e=>n?"api/gateway/object_store.object_store.GetObject/api/v1/objectStore/bucket/next-builder/object/".concat(e):"".concat(window.APP_ROOT?"".concat(window.APP_ROOT,"-/"):"","micro-apps/").concat(r,"/images/").concat(e)});case"I18N":return o?i.identity:a?k(a):b.i18n.getFixedT(null,[l,S("app",c.id)].filter(Boolean));case"I18N_TEXT":return o?q:b.i18nText;case"PERMISSIONS":return T({check:o?G:ia});case"THEME":return T({getTheme:o?()=>"light":x});case"console":return p?T(console):void 0;case"location":return o?{href:"http://localhost:3000/functions/test",origin:"http://localhost:3000",host:"localhost:3000",hostname:"localhost"}:{href:location.href,origin:location.origin,host:location.host,hostname:location.hostname}}}function q(e){return null==e?void 0:e.en}function G(){return!0}function z(){var e,{widgetId:t,widgetVersion:r,collectCoverage:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=new Map,i=new Proxy(Object.freeze({}),{get:(o,s)=>function(o){var s,c=a.get(o);if(c){if(c.processed)return c.cooked;n&&(s=n.createCollector(o));var l=(0,u.precookFunction)(c.source,{typescript:c.typescript,hooks:s&&{beforeVisit:s.beforeVisit}});return c.cooked=(0,u.cook)(l.function,c.source,{rules:{noVar:!0},globalVariables:(0,v.supply)(l.attemptToVisitGlobals,V(l.attemptToVisitGlobals,{collectCoverage:n,widgetId:t,widgetVersion:r,app:e,storyboardFunctions:i,isStoryboardFunction:!0}),!!n),hooks:s&&{beforeEvaluate:s.beforeEvaluate,beforeCall:s.beforeCall,beforeBranch:s.beforeBranch}}),c.processed=!0,c.cooked}}(s)});return{storyboardFunctions:i,registerStoryboardFunctions:function(t,r){if(r&&(e=r),a.clear(),Array.isArray(t))for(var n of t){var o=(0,s.strictCollectMemberUsageInFunction)(n,"FN"),i=(0,s.strictCollectMemberUsageInFunction)(n,"PERMISSIONS").has("check");a.set(n.name,{source:n.source,typescript:n.typescript,deps:o,hasPermissionsCheck:i})}},updateStoryboardFunction(e,t){var r=(0,o.Z)((0,o.Z)({},t),{},{name:e}),n=(0,s.strictCollectMemberUsageInFunction)(r,"FN"),i=(0,s.strictCollectMemberUsageInFunction)(r,"PERMISSIONS").has("check");a.set(e,{source:t.source,typescript:t.typescript,deps:n,hasPermissionsCheck:i})},checkPermissionsUsage(e){var t=new Set,r=e=>{if(!t.has(e)){t.add(e);var n=a.get(e);return!!n&&(n.hasPermissionsCheck||[...n.deps].some(r))}return!1};return e.some(r)}}}var{storyboardFunctions:J,registerStoryboardFunctions:Y,checkPermissionsUsage:Q}=z(),X={};try{X.EventTarget=(new EventTarget).constructor}catch(e){!function(e,t){var r=e.create,n=e.defineProperty,o=a.prototype;function a(){t.set(this,r(null))}function i(e,t,r){n(e,t,{configurable:!0,writable:!0,value:r})}function s(e){var t=e.options;return t&&t.once&&e.target.removeEventListener(this.type,e.listener),"function"==typeof e.listener?e.listener.call(e.target,this):e.listener.handleEvent(this),this._stopImmediatePropagationFlag}i(o,"addEventListener",(function(e,r,n){for(var o=t.get(this),a=o[e]||(o[e]=[]),i=0,s=a.length;i<s;i++)if(a[i].listener===r)return;a.push({target:this,listener:r,options:n})})),i(o,"dispatchEvent",(function(e){var r=t.get(this)[e.type];return r&&(i(e,"target",this),i(e,"currentTarget",this),r.slice(0).some(s,e),delete e.currentTarget,delete e.target),!0})),i(o,"removeEventListener",(function(e,r){for(var n=t.get(this),o=n[e]||(n[e]=[]),a=0,i=o.length;a<i;a++)if(o[a].listener===r)return void o.splice(a,1)})),X.EventTarget=a}(Object,new WeakMap)}const ee=X.EventTarget;var te=function(e){return e.xLarge="xLarge",e.large="large",e.medium="medium",e.small="small",e.xSmall="xSmall",e}({}),re=new Map([[te.xLarge,"1920px"],[te.large,"1600px"],[te.medium,"1280px"],[te.small,"1024px"],[te.xSmall,0]]),ne=new ee,oe={},ae={};function ie(e,t){var r=!1;for(var[n]of(oe[t]=e.matches,re))if(oe[n]&&ae.breakpoint!==n){ae.breakpoint=n,r=!0;break}r&&ne.dispatchEvent(new CustomEvent("change",{detail:ae}))}re.forEach(((e,t)=>{var r=window.matchMedia("(min-width: ".concat(e,")"));ie(r,t),r.addEventListener?r.addEventListener("change",(e=>{ie(e,t)})):r.addListener((e=>{ie(e,t)}))}));var se=()=>ae;function ce(e){return function(t){var r,n="local"===e?localStorage:sessionStorage;return JSON.parse(null!==(r=n.getItem(t))&&void 0!==r?r:"null")}}var le=r(381),ue=r(8874),pe=(r(8525),r(7857)),de=r(2159);function fe(e,t){var r=(0,i.orderBy)(e,(e=>{var t,r,n;return null!==(t=null===(r=e.app)||void 0===r||null===(n=r.homepage)||void 0===n?void 0:n.length)&&void 0!==t?t:0}),"desc");for(var n of r){var o=n.app.homepage;if("string"==typeof o&&"/"===o[0]&&("/"===o?t===o:"".concat(t.replace(/\/+$/,""),"/").startsWith("".concat(o.replace(/\/+$/,""),"/"))))return n}}function ve(e){var t;return!e||(null===(t=io().getCurrentApp())||void 0===t?void 0:t.id)!==e.app.id&&!window.STANDALONE_MICRO_APPS&&e.app.standaloneMode}var he,me=["extraQuery","clear","keepHash"],ge=!1;function ye(e,t){t(!(ge=!confirm(e)))}function be(){if(!he){var e=(0,pe.createBrowserHistory)({basename:W().replace(/\/$/,""),getUserConfirmation:ye});Object.assign(e,function(e){var t,{push:r,replace:n}=e;function a(e,t,n){ge=!1,r(e,t),null==n||n(ge)}function i(e,t,r){ge=!1,n(e,t),null==r||r(ge)}function s(t){return function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0,{extraQuery:s,clear:c,keepHash:l}=n,u=(0,de.Z)(n,me),p=new URLSearchParams(c?"":e.location.search),d={};for(var[f,v]of(Object.assign(d,r,s),Object.entries(d)))if(Array.isArray(v))for(var h of(p.delete(f),v))p.append(f,h);else null==v||""===v?p.delete(f):p.set(f,v);("push"===t?a:i)("?".concat(p.toString()).concat(l?e.location.hash:""),u,o)}}return(0,o.Z)({pushQuery:s("push"),replaceQuery:s("replace"),pushAnchor:function(t,r,n){a((0,o.Z)((0,o.Z)({},e.location),{},{key:void 0,hash:t,state:(0,o.Z)({notify:!1},r)}),void 0,n)},reload:function(t){i((0,o.Z)((0,o.Z)({},e.location),{},{state:(0,o.Z)((0,o.Z)({},e.location.state),{},{notify:!0})}),void 0,t)},setBlockMessage:function(e){t=e},getBlockMessage:function(){return t},unblock:function(){t=void 0}},function(e){var{push:t,replace:r}=e;function n(n){return function(o,a,i){var s,c="string"==typeof o;return"string"==typeof(s=c?(0,pe.parsePath)(o).pathname:o.pathname)&&s.startsWith("/")&&ve(function(e){var t,r;return fe(null!==(t=null===(r=to)||void 0===r?void 0:r.storyboards)&&void 0!==t?t:[],e)}(s))?location["push"===n?"assign":"replace"](c?W()+o.substring(1):e.createHref(o)):("push"===n?t:r)(o,a,i)}}return{push:n("push"),replace:n("replace")}}((0,o.Z)((0,o.Z)({},e),{},{push:a,replace:i})))}(e)),he=e}return he}function we(){return he}var Se=r(5866),Ee=r(6171),ke=r(2308),Ze=function(){var e=(0,a.Z)((function*(e,t){return(yield c.http.post("api/contract/single_search",e,t)).data}));return function(t,r){return e.apply(this,arguments)}}(),Ie=new Map,Ae=new Map,Oe=(e,t)=>{null==e||e.forEach((e=>{t.set("".concat(e.namespaceId,".").concat(e.name),e)}))},Te=new Map;function Pe(e){return e.includes("@")}function _e(e,t,r){return Ce.apply(this,arguments)}function Ce(){return Ce=(0,a.Z)((function*(e,t,r){if(!Pe(e))return t;if(!e.includes(":"))throw new Error("You're using legacy Custom API \"".concat(e,'" which is dropped in v3, please use Flow API instead'));var n=yield function(e){var t=Te.get(e);return t||(t=function(e){return Re.apply(this,arguments)}(e),Te.set(e,t)),t}(e);if(!n)throw new Error('Flow API not found: "'.concat(e,'"'));var o=function(e,t){var r,n,o="string"==typeof t.contract?ke.safeLoad(t.contract,{schema:ke.JSON_SCHEMA,json:!0}):t.contract,{uri:a,method:i="GET",ext_fields:s}=null!==(r=null==o?void 0:o.endpoint)&&void 0!==r?r:{},c=!(null==o||!o.response)&&!1!==o.response.wrapper;if(!a)throw new Error('Missing endpoint.uri in contract of provider "'.concat(e,'"'));return{uri:a,method:"list"===i.toLowerCase()?"get":i,ext_fields:s,name:t.name,namespace:t.namespace,serviceName:t.serviceName,version:t.version,isFileType:"file"===(null==o||null===(n=o.response)||void 0===n?void 0:n.type),responseWrapper:c,request:null==o?void 0:o.request}}(e,n);return function(e,t,r){var n,{uri:o,method:a,ext_fields:i,name:s,namespace:c,serviceName:l,responseWrapper:u,version:p,isFileType:d,request:f}=e,v=d&&"saveAs"===r;v&&(n=t.shift());var{url:h,args:m}=function(e,t,r,n,o,a){var i=a?o?"api/gateway/".concat(o):"api/gateway/".concat(n,".").concat(r,"@").concat(a):"api/gateway/api_service.".concat(n,".").concat(r),s=t.slice();return{url:i+e.replace(/:([^/]+)/g,(()=>s.shift())),args:s}}(o,t,s,c,l,p);return[...v?[n]:[],{url:h,originalUri:o,method:a,ext_fields:i,responseWrapper:u,request:f,isFileType:d},...m]}(o,t,r)})),Ce.apply(this,arguments)}function Re(){return(Re=(0,a.Z)((function*(e){var[t,r]=e.split("@"),[n,o]=r.split(":"),a=function(e){return Ie.get(e)||Ae.get(e)}("".concat(t,".").concat(n));if(a)return{name:a.name,namespace:a.namespaceId,serviceName:a.serviceName,version:a.version,contract:{endpoint:a.endpoint,response:a.response,request:a.request}};var i,s,{contractData:c}=yield Ze({contractName:"".concat(t,".").concat(n),version:o});return c?{name:c.name,namespace:null===(i=c.namespace)||void 0===i||null===(s=i[0])||void 0===s?void 0:s.name,serviceName:c.serviceName,version:c.version,contract:{endpoint:c.endpoint,response:c.response,request:c.request}}:void 0}))).apply(this,arguments)}var Me="core.provider-flow-api";function xe(e,t){return e.some((e=>e.source===t))}function Be(e){return Le.apply(this,arguments)}function Le(){return Le=(0,a.Z)((function*(e){for(var t,{url:r,originalUri:n,method:a="GET",responseWrapper:s=!0,ext_fields:l=[],request:u,isFileType:p}=e,d=["get","delete","head"].includes(a.toLowerCase()),f=p?{responseType:"blob"}:{},v=arguments.length,h=new Array(v>1?v-1:0),m=1;m<v;m++)h[m-1]=arguments[m];if(d){var g,y,b,w,S,E;n&&"object"===(null==u?void 0:u.type)&&(null!==(g=null===(y=n.match(/:([^/]+)/g))||void 0===y?void 0:y.length)&&void 0!==g?g:0)===(null!==(b=null===(w=u.fields)||void 0===w?void 0:w.length)&&void 0!==b?b:0)?[E]=h:[S,E]=h,t=yield c.http.simpleRequest(a,r,(0,o.Z)((0,o.Z)({params:S},f),E))}else{var k=function(e){if(!e||"object"!==e.type)return!1;var t=e=>!(0,i.isEmpty)(e)&&e.some((e=>["file","file[]"].includes(e.type)||t(e.fields)));return t(e.fields)}(u),Z=function(e){for(var t=xe(e,"query"),r=xe(e,"body"),n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];if(t){if(r){var[s,c,l]=a;return{data:s,options:(0,o.Z)({params:c},l)}}var[u,p]=a;return{data:{},options:(0,o.Z)({params:u},p)}}var[d,f]=a;return{data:d,options:f}}(l,...h);t=yield c.http.requestWithBody(a,r,k?function(e){if(e instanceof FormData)return e;var t=new FormData,r=function(e){Array.isArray(o)?o.forEach((r=>{t.append(e,r)})):!(0,i.isObject)(o)||o instanceof Blob||o instanceof Date?t.append(e,o):Object.entries(o).forEach((r=>{var[n,o]=r;t.append("".concat(e,"[").concat(n,"]"),o)}))};for(var[n,o]of Object.entries(e))r(n);return t}(Z.data):Z.data,(0,o.Z)((0,o.Z)({},f),Z.options))}return!p&&s?t.data:t})),Le.apply(this,arguments)}var Ne=new Map;function Ue(e){return je.apply(this,arguments)}function je(){return je=(0,a.Z)((function*(e){Pe(e)&&(e=Me);var t=Ne.get(e);if(t)return t;if(e.includes("-")&&!customElements.get(e))if(e===Me)customElements.define(Me,(0,p.createProviderClass)(Be));else if(yield(0,f.loadBricksImperatively)([e],uo()),!customElements.get(e))throw new Error('Provider not defined: "'.concat(e,'".'));return t=document.createElement(e),Ne.set(e,t),t})),je.apply(this,arguments)}var Fe=new Map;function $e(e,t,r){return Ke.apply(this,arguments)}function Ke(){return(Ke=(0,a.Z)((function*(e,t,r){var{useProvider:n,method:a="resolve",args:i=[],onReject:s}=e,c=e.provider;if(c&&!n)throw new Error("You're using \"provider: ".concat(c,'" which is dropped in v3, please use "useProvider" instead'));var l,[u,p]=yield Promise.all([Ue(n),qo(i,t)]),d=De(u,n,a,p,r,i),{transform:f}=e;try{l=yield d}catch(e){if(!function(e){return!(null==e||!e.transform)}(s))throw e;f=s.transform,l=e}return f?"string"==typeof f?{[f]:l}:qo(f,(0,o.Z)((0,o.Z)({},t),{},{data:l})):l}))).apply(this,arguments)}function De(e,t,r,n,o,a){return We.apply(this,arguments)}function We(){return We=(0,a.Z)((function*(e,t,r,n,o,i){var s,c;try{s=JSON.stringify({useProvider:t,method:r,args:n})}catch(e){if(!i)throw e;s=JSON.stringify({useProvider:t,method:r,originalArgs:i})}return"reload"!==(null==o?void 0:o.cache)&&(c=Fe.get(s)),c||(c=(0,a.Z)((function*(){var o=yield _e(t,n,r);return e.resolve(...o)}))(),Fe.set(s,c)),c})),We.apply(this,arguments)}function Ve(e,t){return He.apply(this,arguments)}function He(){return(He=(0,a.Z)((function*(e,t){return!(0,p.hasOwnProperty)(e,"if")||!!("string"==typeof e.if||$o(e.if)?yield qo(e.if,t):e.if)}))).apply(this,arguments)}function qe(e,t){return!(0,p.hasOwnProperty)(e,"if")||!!("string"==typeof e.if||$o(e.if)?zo(e.if,t):e.if)}function Ge(e){return!(0,p.hasOwnProperty)(e,"if")||!!e.if}function ze(){return(ze=(0,a.Z)((function*(e,t){return(0,p.isObject)(e.if)&&!$o(e.if)?Ge(yield $e(e.if,t)):Ve(e,t)}))).apply(this,arguments)}function Je(e,t){return qe(e,{data:t})}var Ye=function(e){return e[e.INITIAL=0]="INITIAL",e[e.USE_BRICK=1]="USE_BRICK",e[e.USE_BRICK_ITEM=2]="USE_BRICK_ITEM",e[e.USE_BRICK_PROPERTIES=3]="USE_BRICK_PROPERTIES",e[e.USE_BRICK_TRANSFORM=4]="USE_BRICK_TRANSFORM",e[e.USE_BRICK_EVENTS=5]="USE_BRICK_EVENTS",e[e.USE_BRICK_IF=6]="USE_BRICK_IF",e[e.USE_BRICK_SLOTS=7]="USE_BRICK_SLOTS",e[e.USE_BRICK_SLOTS_ITEM=8]="USE_BRICK_SLOTS_ITEM",e[e.USE_BRICK_SLOTS_ITEM_BRICKS=9]="USE_BRICK_SLOTS_ITEM_BRICKS",e[e.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM=10]="USE_BRICK_SLOTS_ITEM_BRICKS_ITEM",e[e.USE_BRICK_LIFECYCLE=11]="USE_BRICK_LIFECYCLE",e[e.USE_BRICK_DATA_SOURCE=12]="USE_BRICK_DATA_SOURCE",e}({});function Qe(e){switch(e){case Ye.USE_BRICK_PROPERTIES:case Ye.USE_BRICK_TRANSFORM:case Ye.USE_BRICK_EVENTS:case Ye.USE_BRICK_IF:case Ye.USE_BRICK_LIFECYCLE:case Ye.USE_BRICK_DATA_SOURCE:return!0}return!1}function Xe(e,t,r){if(Qe(e))return e;if(t)switch(e){case Ye.USE_BRICK:return Ye.USE_BRICK_ITEM;case Ye.USE_BRICK_SLOTS_ITEM_BRICKS:return Ye.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM}else switch(e){case Ye.INITIAL:if("useBrick"===r)return Ye.USE_BRICK;break;case Ye.USE_BRICK:case Ye.USE_BRICK_ITEM:case Ye.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM:switch(r){case"properties":return Ye.USE_BRICK_PROPERTIES;case"transform":return Ye.USE_BRICK_TRANSFORM;case"dataSource":return Ye.USE_BRICK_DATA_SOURCE;case"events":return Ye.USE_BRICK_EVENTS;case"slots":return Ye.USE_BRICK_SLOTS;case"children":return Ye.USE_BRICK_SLOTS_ITEM_BRICKS;case"if":return Ye.USE_BRICK_IF;case"lifeCycle":return Ye.USE_BRICK_LIFECYCLE}break;case Ye.USE_BRICK_SLOTS:return Ye.USE_BRICK_SLOTS_ITEM;case Ye.USE_BRICK_SLOTS_ITEM:if("bricks"===r)return Ye.USE_BRICK_SLOTS_ITEM_BRICKS}return Ye.INITIAL}function et(e){var t=!1,r=!1,n=!1;if("string"==typeof e?(0,u.isEvaluable)(e):$o(e)){var o="string"==typeof e?e:e[jo];t=(0,s.track)(o,"track context","CTX"),r=(0,s.track)(o,"track state","STATE"),n=(0,s.track)(o,"track formstate","FORM_STATE")}return{contextNames:t,stateNames:r,formStateNames:n}}function tt(){return tt=(0,a.Z)((function*(e,t,r){return(0,p.isObject)(e)?Object.fromEntries((yield Promise.all(Object.entries(e).map(function(){var e=(0,a.Z)((function*(e){var[n,o]=e;if(Array.isArray(r)){var{contextNames:a,stateNames:i,formStateNames:s}=et(o);(a||i||s)&&r.push({contextNames:a,stateNames:i,formStateNames:s,propName:n,propValue:o})}var c=yield qo(o,t,{$$lazyForUseBrick:!0,$$stateOfUseBrick:"useBrick"===n?Ye.USE_BRICK:Ye.INITIAL});if("style"!==n&&"dataset"!==n||(0,p.isObject)(c))return[n,c]}));return function(t){return e.apply(this,arguments)}}()))).filter(Boolean)):{}})),tt.apply(this,arguments)}function rt(e,t){if(t)for(var[r,n]of Object.entries(t))switch(r){case"style":case"dataset":for(var[o,a]of Object.entries(n))e[r][o]=a;break;case"constructor":case"__proto__":case"innerHTML":throw new Error("set `".concat(r,"` is prohibited"));default:e[r]=n}}function nt(e,t,r){var n=function(e,t,r){return(0,p.isObject)(e)?Object.fromEntries(Object.entries(e).map((e=>{var[n,o]=e;if(Array.isArray(r)){var{contextNames:a,stateNames:i,formStateNames:s}=et(o);(a||i||s)&&r.push({contextNames:a,stateNames:i,formStateNames:s,propName:n,propValue:o})}var c=zo(o,t,{$$lazyForUseBrick:!0,$$stateOfUseBrick:"useBrick"===n?Ye.USE_BRICK:Ye.INITIAL});if("style"!==n&&"dataset"!==n||(0,p.isObject)(c))return[n,c]})).filter(Boolean)):{}}(t,r);Array.isArray(e)||(e=[e]),e.forEach((e=>{rt(e,n)}))}function ot(e){var t,r;return!(null===(t=e?e.flags:null===(r=io())||void 0===r?void 0:r.getFeatureFlags())||void 0===t||!t["brick-next-v3-strict-mode"])}function at(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];var a=0===n.length?"":",";e?console.error("".concat(t," is dropped in v3 strict mode").concat(a),...n):console.warn("".concat(t," is deprecated in v3 and will be dropped in strict mode").concat(a),...n)}var it=new Set(["prefix"]),st=new WeakMap,ct=new class{constructor(){(0,h.Z)(this,st,{writable:!0,value:new Map})}define(e,t){var r,n,a,s,c=(0,m.Z)(this,st).has(e);c?console.warn('Custom template of "'.concat(e,'" already registered.')):(c=!!customElements.get(e))&&console.warn('Custom template of "'.concat(e,'" already defined by customElements.'));var l=ot(),u=null!==(r=null===(n=t.proxy)||void 0===n?void 0:n.properties)&&void 0!==r?r:{},p=[],d=[];for(var[f,v]of Object.entries(u))v.asVariable?(at(l,"Template `asVariable`",e,f),l||d.push(f)):v.mergeProperty||v.refTransform?console.error("Template `mergeProperty` and `refTransform` are dropped in v3:",e,f):v.ref&&p.push([f,v]);var h=(0,o.Z)((0,o.Z)({},t),{},{proxy:(0,o.Z)((0,o.Z)({},t.proxy),{},{properties:Object.fromEntries(p)}),state:(t.state?l?t.state:t.state.map((e=>(0,o.Z)({expose:!0},e))):[]).concat(d.map((e=>({name:e,expose:!0}))))});(0,m.Z)(this,st).set(e,(0,o.Z)((0,o.Z)({},h),{},{name:e}));var g,y,b=(g=h.state,(0,i.uniq)(null!==(y=null==g?void 0:g.filter((e=>e.expose)).map((e=>e.name)))&&void 0!==y?y:[])),w=Object.entries(null!==(a=null===(s=h.proxy)||void 0===s?void 0:s.methods)&&void 0!==a?a:{}),S=b.concat(p.map((e=>e[0]))),E=w.map((e=>e[0])),k=S.concat(E).filter((e=>e in HTMLElement.prototype&&!it.has(e)));if(k.length>0&&(at(l,"Using native HTMLElement properties as template properties or methods",e,...k),l))throw new Error('In custom template "'.concat(e,'", ').concat(k.map((e=>'"'.concat(e,'"'))).join(", ")," are native HTMLElement properties, and should be avoid to be used as brick properties or methods."));if(!c){class t extends HTMLElement{get $$typeof(){return"custom-template"}static get _dev_only_definedProperties(){return S}static get _dev_only_definedMethods(){return E}$$getElementByRef(e){var t,r,n,o;return null===(t=this.$$tplStateStore)||void 0===t||null===(r=t.hostBrick)||void 0===r||null===(n=r.tplHostMetadata)||void 0===n||null===(o=n.internalBricksByRef.get(e))||void 0===o?void 0:o.element}connectedCallback(){var e=this.shadowRoot;e||(e=this.attachShadow({mode:"open"}));var t=document.createDocumentFragment(),r=document.createElement("style");r.textContent=":host{display:block}:host([hidden]){display:none}";var n=document.createElement("slot");t.appendChild(r),t.appendChild(n),e.appendChild(t)}disconnectedCallback(){this.shadowRoot&&(this.shadowRoot.textContent="")}}var Z=function(r){if(p.some((e=>e[0]===r)))return console.error('Cannot define an exposed state that is also a proxy property: "'.concat(r,'" in ').concat(e)),"continue";Object.defineProperty(t.prototype,r,{get(){return this.$$tplStateStore.getValue(r)},set(e){var t;null===(t=this.$$tplStateStore)||void 0===t||t.updateValue(r,e,"replace")},enumerable:!0})};for(var I of b)Z(I);var A=function(e,r){Object.defineProperty(t.prototype,e,{get(){var t;return this.$$getElementByRef(r.ref)[null!==(t=r.refProperty)&&void 0!==t?t:e]},set(t){var n,o,a=null===(n=this.$$getElementByRef)||void 0===n?void 0:n.call(this,r.ref);a&&(a[null!==(o=r.refProperty)&&void 0!==o?o:e]=t)},enumerable:!0})};for(var[O,T]of p)A(O,T);var P=function(e,r){Object.defineProperty(t.prototype,e,{value(){var t;this.$$getElementByRef(r.ref)[null!==(t=r.refMethod)&&void 0!==t?t:e](...arguments)},enumerable:!0})};for(var[_,C]of w)P(_,C);customElements.define(e,t)}}get(e){return(0,m.Z)(this,st).get(e)}};function lt(e,t,r){var{tplStateStoreId:n,tplStateStoreMap:o}=e;if(!n)throw new Error('Using "'.concat(t,'" outside of a custom template').concat(null!=r?r:""));var a=o.get(n);if(!a)throw new Error('Template state store is not found when using "'.concat(t,'"').concat(null!=r?r:"",".\nThis is a bug of Brick Next, please report it."));return a}function ut(e,t,r){var n=lt(e,t,r).hostBrick.element;if(!n)throw new Error('Template host element is gone when using "'.concat(t,'"').concat(null!=r?r:"",".\nThis is a bug of Brick Next, please report it."));return n}function pt(e,t,r){var{formStateStoreId:n,formStateStoreMap:o}=e;if(!n)throw new Error('Using "'.concat(t,'" outside of form renderer').concat(null!=r?r:""));var a=o.get(n);if(!a)throw new Error('Form state store is not found when using "'.concat(t,'"').concat(null!=r?r:"",".\nThis is a bug of Brick Next, please report it."));return a}function dt(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function ft(e){return e&&e.sensitive?"":"i"}function vt(e,t,r){return function(e,t,r){void 0===r&&(r={});for(var n=r.strict,o=void 0!==n&&n,a=r.start,i=void 0===a||a,s=r.end,c=void 0===s||s,l=r.encode,u=void 0===l?function(e){return e}:l,p=r.delimiter,d=void 0===p?"/#?":p,f=r.endsWith,v="[".concat(dt(void 0===f?"":f),"]|$"),h="[".concat(dt(d),"]"),m=i?"^":"",g=0,y=e;g<y.length;g++){var b=y[g];if("string"==typeof b)m+=dt(u(b));else{var w=dt(u(b.prefix)),S=dt(u(b.suffix));if(b.pattern)if(t&&t.push(b),w||S)if("+"===b.modifier||"*"===b.modifier){var E="*"===b.modifier?"?":"";m+="(?:".concat(w,"((?:").concat(b.pattern,")(?:").concat(S).concat(w,"(?:").concat(b.pattern,"))*)").concat(S,")").concat(E)}else m+="(?:".concat(w,"(").concat(b.pattern,")").concat(S,")").concat(b.modifier);else"+"===b.modifier||"*"===b.modifier?m+="((?:".concat(b.pattern,")").concat(b.modifier,")"):m+="(".concat(b.pattern,")").concat(b.modifier);else m+="(?:".concat(w).concat(S,")").concat(b.modifier)}}if(c)o||(m+="".concat(h,"?")),m+=r.endsWith?"(?=".concat(v,")"):"$";else{var k=e[e.length-1],Z="string"==typeof k?h.indexOf(k[k.length-1])>-1:void 0===k;o||(m+="(?:".concat(h,"(?=").concat(v,"))?")),Z||(m+="(?=".concat(h,"|").concat(v,")"))}return new RegExp(m,ft(r))}(function(e,t){void 0===t&&(t={});for(var r=function(e){for(var t=[],r=0;r<e.length;){var n=e[r];if("*"!==n&&"+"!==n&&"?"!==n)if("\\"!==n)if("{"!==n)if("}"!==n)if(":"!==n)if("("!==n)t.push({type:"CHAR",index:r,value:e[r++]});else{var o=1,a="";if("?"===e[s=r+1])throw new TypeError('Pattern cannot start with "?" at '.concat(s));for(;s<e.length;)if("\\"!==e[s]){if(")"===e[s]){if(0==--o){s++;break}}else if("("===e[s]&&(o++,"?"!==e[s+1]))throw new TypeError("Capturing groups are not allowed at ".concat(s));a+=e[s++]}else a+=e[s++]+e[s++];if(o)throw new TypeError("Unbalanced pattern at ".concat(r));if(!a)throw new TypeError("Missing pattern at ".concat(r));t.push({type:"PATTERN",index:r,value:a}),r=s}else{for(var i="",s=r+1;s<e.length;){var c=e.charCodeAt(s);if(!(c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||95===c))break;i+=e[s++]}if(!i)throw new TypeError("Missing parameter name at ".concat(r));t.push({type:"NAME",index:r,value:i}),r=s}else t.push({type:"CLOSE",index:r,value:e[r++]});else t.push({type:"OPEN",index:r,value:e[r++]});else t.push({type:"ESCAPED_CHAR",index:r++,value:e[r++]});else t.push({type:"MODIFIER",index:r,value:e[r++]})}return t.push({type:"END",index:r,value:""}),t}(e),n=t.prefixes,o=void 0===n?"./":n,a="[^".concat(dt(t.delimiter||"/#?"),"]+?"),i=[],s=0,c=0,l="",u=function(e){if(c<r.length&&r[c].type===e)return r[c++].value},p=function(e){var t=u(e);if(void 0!==t)return t;var n=r[c],o=n.type,a=n.index;throw new TypeError("Unexpected ".concat(o," at ").concat(a,", expected ").concat(e))},d=function(){for(var e,t="";e=u("CHAR")||u("ESCAPED_CHAR");)t+=e;return t};c<r.length;){var f=u("CHAR"),v=u("NAME"),h=u("PATTERN");if(v||h){var m=f||"";-1===o.indexOf(m)&&(l+=m,m=""),l&&(i.push(l),l=""),i.push({name:v||s++,prefix:m,suffix:"",pattern:h||a,modifier:u("MODIFIER")||""})}else{var g=f||u("ESCAPED_CHAR");if(g)l+=g;else if(l&&(i.push(l),l=""),u("OPEN")){m=d();var y=u("NAME")||"",b=u("PATTERN")||"",w=d();p("CLOSE"),i.push({name:y||(b?s++:""),pattern:y&&!b?a:b,prefix:m,suffix:w,modifier:u("MODIFIER")||""})}else p("END")}}return i}(e,r),t,r)}function ht(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;for(var r=/\((?:\?<(.*?)>)?(?!\?)/g,n=0,o=r.exec(e.source);o;)t.push({name:o[1]||n++,prefix:"",suffix:"",modifier:"",pattern:""}),o=r.exec(e.source);return e}(e,t):Array.isArray(e)?function(e,t,r){var n=e.map((function(e){return ht(e,t,r).source}));return new RegExp("(?:".concat(n.join("|"),")"),ft(r))}(e,t,r):vt(e,t,r)}var mt=new Map,gt=1e4,yt=0;function bt(e,t){var{path:r,exact:n=!1,strict:o=!1,sensitive:a=!0}=t;return(Array.isArray(r)?r:[r]).reduce(((t,r)=>{if(t)return t;var{regexp:i,keys:s}=function(e,t){var r="".concat(t.end).concat(t.strict).concat(t.sensitive),n=mt.get(r);n||mt.set(r,n=new Map);var o=n.get(e);if(o)return o;var a=[],i={regexp:ht(e,a,t),keys:a};return yt<gt&&(n.set(e,i),yt++),i}(r,{end:n,strict:o,sensitive:a}),c=i.exec(e);if(!c)return null;var[l,...u]=c,p=e===l;return n&&!p?null:{path:r,url:"/"===r&&""===l?"/":l,isExact:p,params:s.reduce(((e,t,r)=>(e[t.name]=u[r],e)),{})}}),null)}function wt(){return(wt=(0,a.Z)((function*(e,t){for(var r of e){if("string"!=typeof r.path)throw console.error("Invalid route with invalid path:",r),new Error("Invalid route with invalid type of path: ".concat(typeof r.path));var n=r.path.replace(/^\$\{APP.homepage\}/,t.app.homepage),o=bt(t.location.pathname,{path:n,exact:r.exact});if(o&&(yield Ve(r,t)))return t.app.noAuthGuard||r.public||pa()?{match:o,route:r}:"unauthenticated"}return"missed"}))).apply(this,arguments)}var St,Et=Symbol.for("tpl.asyncComputedPropsFromHost"),kt=Symbol.for("tpl.stateStoreId"),Zt=Symbol.for("tpl.externalForEachItem"),It=r(6666),At=new Set,Ot=function(e){return e.REQUEST_FAILED="REQUEST_FAILED",e.SOMETHING_WENT_WRONG="SOMETHING_WENT_WRONG",e.LOGIN_TIMEOUT_MESSAGE="LOGIN_TIMEOUT_MESSAGE",e.NETWORK_ERROR="NETWORK_ERROR",e}({}),Tt={[Ot.REQUEST_FAILED]:"Request Failed",[Ot.SOMETHING_WENT_WRONG]:"Something went wrong!",[Ot.LOGIN_TIMEOUT_MESSAGE]:"You haven't logged in or your login session has expired. Login right now?",[Ot.NETWORK_ERROR]:"Network error, please check your network."},Pt={[Ot.REQUEST_FAILED]:"请求失败",[Ot.SOMETHING_WENT_WRONG]:"出现了一些问题！",[Ot.LOGIN_TIMEOUT_MESSAGE]:"您还未登录或登录信息已过期，现在重新登录？",[Ot.NETWORK_ERROR]:"网络错误，请检查您的网络连接。"},_t="core/runtime",Ct={en:Tt,zh:Pt},Rt=Object.freeze({show:function(e){return St?St.resolve(e):"confirm"===e.type?confirm(e.content)?new Promise((e=>setTimeout((()=>{e()}),1))):new Promise(((e,t)=>setTimeout((()=>{t()}),1))):(alert(e.content),new Promise((e=>setTimeout((()=>{e()}),1e3))))}});function Mt(e){if(e instanceof Event&&e.target instanceof HTMLScriptElement)return e.target.src;if(e instanceof c.HttpFetchError)return b.i18n.t("".concat(_t,":").concat(Ot.NETWORK_ERROR));if(e instanceof c.HttpResponseError&&e.responseJson){if("string"==typeof e.responseJson.error)return e.responseJson.error;if("string"==typeof e.responseJson.msg)return e.responseJson.msg}return null==e?"Unknown error":e.toString()}function xt(e){return e instanceof c.HttpResponseError&&401===e.response.status&&!!e.responseJson&&100003===e.responseJson.code}var Bt,Lt,Nt=!1;function Ut(e){if(!(e instanceof c.HttpAbortError)){if(xt(e)&&!window.NO_AUTH_GUARD){if(Nt)return;return Nt=!0,void Rt.show({type:"confirm",content:b.i18n.t("".concat(_t,":").concat(Ot.LOGIN_TIMEOUT_MESSAGE))}).then((()=>{var e,t;e=io().getFeatureFlags()["sso-enabled"],(t=we()).push(e?"/sso-auth/login":"/auth/login",{from:(0,o.Z)((0,o.Z)({},t.location),{},{state:void 0})}),Nt=!1}),(()=>{Nt=!1}))}console.error(e);var t=Mt(e);t!==Bt&&(Bt=t,Rt.show({type:"error",title:b.i18n.t("".concat(_t,":").concat(Ot.REQUEST_FAILED)),content:t,contentStyle:{whiteSpace:"pre-wrap"}}).then((()=>{Bt=void 0})))}}var jt=Object.freeze({show:function(e){Lt?Lt.resolve(e):alert(e.message)}});function Ft(e,t,r){t&&Object.entries(t).forEach((t=>{var[n,o]=t,a=Wt(o,r,{element:e});for(var i of(e.addEventListener(n,a),e.$$listeners||(e.$$listeners=[]),e.$$listeners.push([n,a]),e.$$eventListeners||(e.$$eventListeners=[]),[].concat(o)))e.$$eventListeners.push([n,null,i])}))}function $t(e){return"string"==typeof e.action}function Kt(e){return"string"==typeof e.useProvider}function Dt(e){return!(!e.target&&!e.targetRef||!e.method&&!e.properties)}function Wt(e,t,r){return function(n){for(var a of[].concat(e))if(qe(a,(0,o.Z)((0,o.Z)({},t),{},{event:n})))if($t(a)){var[i,s]=a.action.split(".");switch(a.action){case"history.push":case"history.replace":case"history.pushQuery":case"history.replaceQuery":case"history.pushAnchor":case"history.block":case"history.goBack":case"history.goForward":case"history.reload":case"history.unblock":Jt(n,s,a.args,a.callback,t);break;case"window.open":Yt(n,a.args,t);break;case"location.reload":case"location.assign":tr(n,s,a.args,t);break;case"localStorage.setItem":case"localStorage.removeItem":case"sessionStorage.setItem":case"sessionStorage.removeItem":rr(n,i,s,a.args,t);break;case"event.preventDefault":n.preventDefault();break;case"console.log":case"console.error":case"console.warn":case"console.info":nr(n,s,a.args,t);break;case"message.success":case"message.error":case"message.info":case"message.warn":or(n,s,a.args,t);break;case"handleHttpError":Ut(n.detail);break;case"context.assign":case"context.replace":case"context.refresh":case"context.load":Qt(n,s,a.args,a.callback,t);break;case"state.update":case"state.refresh":case"state.load":Xt(n,s,a.args,a.callback,t);break;case"tpl.dispatchEvent":var[c,l]=ir(a.args,t,n);ut(t,a.action,": ".concat(c)).dispatchEvent(new CustomEvent(c,l));break;case"formstate.update":er(n,a.args,a.callback,t);break;case"theme.setDarkTheme":case"theme.setLightTheme":L("theme.setDarkTheme"===a.action?"dark":"light");break;case"theme.setTheme":var[u]=ir(a.args,t,n);L(u);break;case"mode.setDashboardMode":case"mode.setDefaultMode":K("mode.setDashboardMode"===a.action?"dashboard":"default");break;default:console.error("unknown event listener action:",a.action)}}else Kt(a)?Vt(n,a,t,r):Dt(a)?qt(n,a,t,r):console.error("unknown event handler:",a)}}function Vt(e,t,r,n){return Ht.apply(this,arguments)}function Ht(){return(Ht=(0,a.Z)((function*(e,t,r,n){try{Gt(e,yield Ue(t.useProvider),t,"saveAs"!==t.method?"resolve":"saveAs",r,n)}catch(e){console.error(Mt(e))}}))).apply(this,arguments)}function qt(e,t,r,n){var a=[],i=t.target,s=t.targetRef,c=i;if(("string"==typeof i?(0,u.isEvaluable)(i):$o(i))&&(c=zo(i,(0,o.Z)((0,o.Z)({},r),{},{event:e}))),"string"==typeof c)if("_self"===c)a.push(n.element);else if(t.multiple)a=Array.from(document.querySelectorAll(c));else{var l=document.querySelector(c);null!==l&&a.push(l)}else if(c)c instanceof HTMLElement?a.push(c):console.error("unexpected target:",c);else if(s){var p=s;("string"==typeof s?(0,u.isEvaluable)(s):$o(s))&&(p=zo(s,(0,o.Z)((0,o.Z)({},r),{},{event:e})));var d=[].concat(p),f=ut(r,"targetRef",": ".concat(d.join(", ")));a.push(...d.map((e=>{var t;return null===(t=f.$$getElementByRef)||void 0===t?void 0:t.call(f,e)})).filter(Boolean))}0!==a.length?function(e){return!!e.method}(t)?a.forEach((o=>{Gt(e,o,t,t.method,r,n,{useEventAsDefault:!0})})):function(e){return!!e.properties}(t)&&nt(a,t.properties,(0,o.Z)((0,o.Z)({},r),{},{event:e})):console.error("target not found:",i||s)}function Gt(e,t,r,n,o,a,i){return zt.apply(this,arguments)}function zt(){return zt=(0,a.Z)((function*(e,t,r,n,i,s,c){var l;if("function"==typeof t[n]){var u=function(){var o=(0,a.Z)((function*(){var o=ir(r.args,i,e,c);return Kt(r)&&(o=yield _e(r.useProvider,o,n)),t[n](...o)}));return function(){return o.apply(this,arguments)}}();if(r.callback){var p,d=ar(r.callback,i,s),f={progress:d("progress"),success:d("success"),error:d("error"),finally:d("finally")};if(Kt(r)&&(p=zo(r.poll,(0,o.Z)((0,o.Z)({},i),{},{event:e}))),null!==(l=p)&&void 0!==l&&l.enabled)!function(e,t,r){var n,{progress:o,success:i,error:s,finally:c}=t,{interval:l,leadingRequestDelay:u,continueOnError:p,delegateLoadingBar:d,expectPollEnd:f,expectPollStopImmediately:v}=r,h=po();function m(){return g.apply(this,arguments)}function g(){return(g=(0,a.Z)((function*(){var t;At.delete(n);try{if(!(t=null==v?void 0:v())){var r=yield e();(t=(null==v?void 0:v())||h!==po())||(null==o||o(r),null!=f&&f(r)?(d&&window.dispatchEvent(new Event("request.end")),null==i||i(r),null==c||c()):y(null!=l?l:3e3))}}catch(e){(t=(null==v?void 0:v())||h!==po())||(null==s||s(e),p?y(null!=l?l:3e3):null==c||c())}finally{d&&t&&window.dispatchEvent(new Event("request.end"))}}))).apply(this,arguments)}function y(e){n=setTimeout(m,e),At.add(n)}y(null!=u?u:0),d&&window.dispatchEvent(new Event("request.start"))}(u,f,p);else try{var v=yield u();f.success(v)}catch(e){f.error(e)}finally{f.finally()}}else u()}else console.error("target has no method:",{target:t,method:n})})),zt.apply(this,arguments)}function Jt(e,t,r,n,o){var a=0,i=!1,s=t;switch(t){case"push":case"replace":case"pushQuery":case"replaceQuery":case"pushAnchor":a=2,i=!0;break;case"reload":i=!0;break;case"block":a=1,s="setBlockMessage"}var c=[];if(a>0&&((c=ir(r,o,e,{useEventDetailAsDefault:!0})).length=a),i&&n){var l=ar(n,o,void 0);c.push((e=>{l(e?"error":"success")({blocked:e}),l("finally")({blocked:e})}))}we()[s](...c)}function Yt(e,t,r){var[n,o,a]=ir(t,r,e);window.open(n,o||"_self",a)}function Qt(e,t,r,n,o){var[a,i]=ir(r,o,e);o.ctxStore.updateValue(a,i,t,n,o)}function Xt(e,t,r,n,o){var[a,i]=ir(r,o,e);lt(o,"state.".concat(t),": ".concat(a)).updateValue(a,i,"update"===t?"replace":t,n,o)}function er(e,t,r,n){var[o,a]=ir(t,n,e);pt(n,"formstate.update",": ".concat(o)).updateValue(o,a,"replace",r,n)}function tr(e,t,r,n){if("assign"===t){var[o]=ir(r,n,e);location.assign(o)}else location[t]()}function rr(e,t,r,n,o){var a="localStorage"===t?localStorage:sessionStorage,[i,s]=ir(n,o,e);"setItem"===r?void 0!==s&&a.setItem(i,JSON.stringify(s)):a.removeItem(i)}function nr(e,t,r,n){console[t](...ir(r,n,e,{useEventAsDefault:!0}))}function or(e,t,r,n){var o=ir(r,n,e,{useEventAsDefault:!0});jt.show({type:t,message:o[0]})}function ar(e,t,r){return function(n){return function(o){var a=null==e?void 0:e[n];if(a)try{var i=new CustomEvent("callback.".concat(n),{detail:o});Wt(a,t,r)(i)}catch(e){console.error(e)}else"error"===n&&console.error("Unhandled callback error:",o)}}}function ir(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Array.isArray(e)?zo(e,(0,o.Z)((0,o.Z)({},t),{},{event:r})):n.useEventAsDefault?[r]:n.useEventDetailAsDefault?[r.detail]:[]}class sr{constructor(e,t){(0,It.Z)(this,"type",void 0),(0,It.Z)(this,"data",new Map),(0,It.Z)(this,"changeEventType",void 0),(0,It.Z)(this,"pendingStack",[]),(0,It.Z)(this,"hostBrick",void 0),this.type=e,this.changeEventType="FORM_STATE"===this.type?"formstate.change":"STATE"===this.type?"state.change":"context.change",this.hostBrick=t}getValue(e){var t;return null===(t=this.data.get(e))||void 0===t?void 0:t.value}updateValue(e,t,r,n,a){var i=this.data.get(e);if(!i)throw new Error("".concat(this.type," '").concat(e,"' is not defined"));if("refresh"!==r&&"load"!==r)"replace"===r?i.value=t:(0,p.isObject)(i.value)?Object.assign(i.value,t):(console.warn('Non-object current value of "'.concat(this.type,".").concat(e,'" for "context.assign", try "context.replace" instead.')),i.value=t),i.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType,{detail:i.value}));else{if(!i.load)throw new Error("You can not ".concat(r,' "').concat(this.type,".").concat(e,'" which has no resolve'));var s;if("load"===r&&(i.loaded?s=Promise.resolve(i.value):i.loading&&(s=i.loading)),s||(s=i.loading=i.load((0,o.Z)({cache:"load"===r?"default":"reload"},t))).then((e=>{i.loaded=!0,i.value=e,i.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType,{detail:i.value}))}),(e=>{null!=n&&n.error||Ut(e)})),n){var c=ar(n,a);s.then((e=>{c("success")({value:e}),c("finally")()}),(e=>{c("error")(e),c("finally")()}))}}}define(e,t,r){if(Array.isArray(e)&&e.length>0){var n=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"CTX",n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CTX",r=new Map;for(var n of e){var o=(0,s.collectMemberUsage)([n.if,n.value,n.resolve],t);r.set(n,o)}return r}(e,r),o=new Map;for(var i of Array.from(n.keys()).map((e=>e.name))){var c;o.set(i,(null!==(c=o.get(i))&&void 0!==c?c:0)+1)}var l=Array.from(n.values()).some((e=>e.hasNonStaticUsage)),u=new WeakSet,p=new Map,d=new Map([...new Set(e.map((e=>e.name)))].map((e=>[e,new Promise(((t,r)=>{p.set(e,{resolve:t,reject:r})}))]))),f=function(){var e=(0,a.Z)((function*(e){var r;u.add(e);var a=yield t(e);n.delete(e);var i=null!==(r=o.get(e.name))&&void 0!==r?r:0;if(a){if(p.get(e.name).resolve(),o.delete(e.name),0===i)throw new Error("Duplicated context defined: ".concat(e.name))}else 1===i?(p.get(e.name).resolve(),o.delete(e.name)):o.set(e.name,i-1);yield h()}));return function(t){return e.apply(this,arguments)}}(),v=l;function h(){return m.apply(this,arguments)}function m(){return m=(0,a.Z)((function*(){var e=Array.from(n.entries()).filter(function(e,t){return(r,n)=>t?0===n:![...r[1].usedProperties].some((t=>e.has(t)))}(o,v)).map((e=>e[0])).filter((e=>!u.has(e)));yield Promise.all(e.map(f))})),m.apply(this,arguments)}return{pendingResult:h().then((0,a.Z)((function*(){for(var e of(n.size>0&&(function(e,t){var r=new Map(e),n=new Set(Array.from(r.keys()).map((e=>e.name))),o=()=>{var e=!1;for(var[t,a]of r.entries())[...a.usedProperties].some((e=>n.has(e)))||(r.delete(t),n.delete(t.name),e=!0);e&&o()};if(o(),r.size>0)throw new ReferenceError("Circular ".concat(t," detected: ").concat(Array.from(r.keys()).map((e=>e.name)).join(", ")))}(n,r),v=!0,yield h()),p.values()))e.resolve()}))).catch((e=>{for(var t of p.values())t.reject(e);throw e})),pendingContexts:d}}(e,(e=>this.resolve(e,t,r)),this.type);this.pendingStack.push(n)}}onChange(e,t){var r;null===(r=this.data.get(e))||void 0===r||r.eventTarget.addEventListener(this.changeEventType,t)}waitFor(e){var t=this;return(0,a.Z)((function*(){var r=function*(t){yield Promise.all([...e].map((e=>t.get(e))))};for(var{pendingContexts:n}of t.pendingStack)yield*r(n)}))()}waitForAll(){var e=this;return(0,a.Z)((function*(){for(var{pendingResult:t}of e.pendingStack)yield t}))()}resolve(e,t,r){var n=this;return(0,a.Z)((function*(){if(!(yield Ve(e,t)))return!1;var i,c;if(r&&("STATE"===n.type?e.expose:"FORM_STATE"===n.type)){var l=yield r;(0,p.hasOwnProperty)(l,e.name)&&(i=l[e.name])}var u=!1;if(void 0===i){if(e.resolve){var d=(0,o.Z)({transform:"value"},e.resolve);if(yield Ve(e.resolve,t))c=function(){var e=(0,a.Z)((function*(e){return(yield $e(d,t,e)).value}));return function(t){return e.apply(this,arguments)}}(),(u=e.resolve.lazy)||(i=yield c());else if(!(0,p.hasOwnProperty)(e,"value"))return!1}c&&!u||void 0===e.value||(i=yield qo(e.value,t))}var f={value:i,eventTarget:new EventTarget,load:c,loaded:!u};if(e.onChange&&f.eventTarget.addEventListener(n.changeEventType,Wt(e.onChange,t)),e.track){var v=(0,s.strictCollectMemberUsage)(c?e.resolve:e.value,n.type);for(var h of v)n.onChange(h,(()=>{c?n.updateValue(e.name,{cache:"default"},"refresh"):n.updateValue(e.name,zo(e.value,t),"replace")}))}if(n.data.has(e.name))throw new Error("".concat(n.type," '").concat(e.name,"' has already been declared"));return n.data.set(e.name,f),!0}))()}}function cr(e,t,r){var n,{reversedProxies:o,asyncHostProperties:a,externalSlots:s,tplStateStoreId:c,hostBrick:l}=e;if(t&&o){var u=o.properties.get(t);u&&(n=a.then((e=>{var t={};for(var{from:r,to:n}of u){var o=e[r];void 0!==o&&n.refProperty&&(t[n.refProperty]=o)}return t})));var d=o.slots.get(t);if(d&&s){var f=new Map;for(var{from:v,to:h}of d){var m,g,y,b,w=null!==(m=null===(g=s[v])||void 0===g?void 0:g.bricks)&&void 0!==m?m:[];if(w.length){var S=null!==(y=h.refSlot)&&void 0!==y?y:v,E=f.get(S);if(!E){E=[];for(var k=(0,p.hasOwnProperty)(r,S)?r[S].bricks.length+1:1,Z=0;Z<k;Z+=1)E.push([]);f.set(S,E)}var I=null!==(b=h.refPosition)&&void 0!==b?b:-1;E[(0,i.clamp)(I<0?E.length+I:I,0,E.length-1)].push(...(0,p.hasOwnProperty)(l.runtimeContext,"forEachItem")?lr(w,l.runtimeContext.forEachItem):w)}}var A=function(){(0,p.hasOwnProperty)(r,O)||(r[O]={type:"bricks",bricks:[]});var e=r[O];e.bricks=T.flatMap(((t,r)=>r<e.bricks.length?t.concat(e.bricks[r]):t)),0===e.bricks.length&&delete r[O]};for(var[O,T]of f.entries())A()}}return{[Et]:n,[kt]:c}}function lr(e,t){return e.map((e=>{var r;return(0,o.Z)((0,o.Z)({},e),{},{[Zt]:t,slots:Object.fromEntries(Object.entries(null!==(r=e.slots)&&void 0!==r?r:{}).map((e=>{var r,[n,o]=e;return[n,"routes"===o.type?{type:"routes",routes:ur(o.routes,t)}:{type:"bricks",bricks:lr(null!==(r=o.bricks)&&void 0!==r?r:[],t)}]})))})}))}function ur(e,t){return e.map((e=>e.type&&"bricks"!==e.type?e:(0,o.Z)((0,o.Z)({},e),{},{bricks:lr(e.bricks,t)})))}var pr=["properties","slots","children"];function dr(e,t){function r(e){return(0,p.isObject)(e)?Array.isArray(e)?e.map(r):Object.fromEntries(Object.entries(e).map((e=>{var[t,o]=e;return(0,p.isObject)(o)&&"useBrick"===t?Array.isArray(o)?[t,o.map(n)]:[t,n(o)]:[t,r(o)]})).concat(Object.getOwnPropertySymbols(e).map((t=>[t,e[t]])))):e}function n(e){var{properties:a,slots:i,children:s}=e,c=(0,de.Z)(e,pr),l=Mr(s,i),u=Object.fromEntries(Object.entries(null!=l?l:{}).map((e=>{var t,[r,o]=e;return[r,{type:"bricks",bricks:(null!==(t=o.bricks)&&void 0!==t?t:[]).map(n)}]})));return(0,o.Z)((0,o.Z)({},c),{},{properties:r(a),slots:u},cr(t,c.ref,u))}return r(e)}var fr=["slots","children"],vr=["properties","slots","children"];function hr(e,t,r,n){var a=(0,i.uniqueId)("tpl-state-"),s=(0,o.Z)((0,o.Z)({},r.runtimeContext),{},{tplStateStoreId:a});delete s.forEachItem,delete s.formStateStoreId;var c=new sr("STATE",r);s.tplStateStoreMap.set(a,c),s.tplStateStoreScope&&s.tplStateStoreScope.push(c);var{bricks:l,proxy:u,state:p,contracts:d}=ct.get(e);!function(e){Oe(e,Ae)}(d),c.define(p,s,n);var{slots:f,children:v}=t,h=(0,de.Z)(t,fr),m=(0,o.Z)((0,o.Z)({},h),{},{brick:e});r.tplHostMetadata={internalBricksByRef:new Map,tplStateStoreId:a,proxy:u};var g={properties:new Map,slots:new Map};if(null!=u&&u.properties)for(var[y,b]of Object.entries(u.properties)){var w=g.properties.get(b.ref);w||(w=[],g.properties.set(b.ref,w)),w.push({from:y,to:b})}if(null!=u&&u.slots)for(var[S,E]of Object.entries(u.slots)){var k=g.slots.get(E.ref);k||(k=[],g.slots.set(E.ref,k)),k.push({from:S,to:E})}var Z={reversedProxies:g,asyncHostProperties:n,externalSlots:Mr(v,f),tplStateStoreId:a,hostBrick:r};return m.slots={"":{type:"bricks",bricks:l.map((e=>mr(e,Z)))}},m}function mr(e,t){null===e.if&&delete e.if;var{properties:r,slots:n,children:a}=e,i=(0,de.Z)(e,vr),s=Mr(a,n),c=Object.fromEntries(Object.entries(null!=s?s:{}).map((e=>{var r,[n,o]=e;return[n,{type:"bricks",bricks:(null!==(r=o.bricks)&&void 0!==r?r:[]).map((e=>mr(e,t)))}]})));return(0,o.Z)((0,o.Z)({},i),{},{properties:dr(r,t),slots:c},cr(t,i.ref,c))}var gr=function(e){return e[e.ROOT=1]="ROOT",e[e.BRICK=2]="BRICK",e}({}),yr="form-renderer.form-renderer",br=Symbol.for("form.stateStoreId");function wr(e,t,r){var{id:n,bricks:a,events:i,context:s,mountPoint:c,instanceId:l}=e,{brick:u,properties:d}=e,f=t.find((e=>e.fieldId===n));if(f){var v=function(e){var t,r={id:e.fieldId,name:e.fieldId,label:e.name,dataset:{testid:e.fieldId}},n=()=>{var t,r;return{readOnly:null===(t=e.limit)||void 0===t?void 0:t.includes("READONLY"),required:null===(r=e.limit)||void 0===r?void 0:r.includes("REQUIRED")}};switch(e.fieldType){case"INT":t={brick:"forms.general-input-number",properties:(0,o.Z)((0,o.Z)((0,o.Z)({},r),n()),{},{placeholder:e.description,precision:0,inputBoxStyle:{width:"100%"}})};break;case"BOOLEAN":t={brick:"forms.general-switch",properties:(0,o.Z)((0,o.Z)({},r),n())};break;case"FLOAT":t={brick:"forms.general-input-number",properties:(0,o.Z)((0,o.Z)((0,o.Z)({},r),n()),{},{placeholder:e.description,inputBoxStyle:{width:"100%"}})};break;case"ENUM":t={brick:"forms.general-select",properties:(0,o.Z)((0,o.Z)((0,o.Z)({},r),n()),{},{options:[{label:"选项一",value:1},{label:"选项二",value:2}],placeholder:e.description,inputBoxStyle:{width:"100%"}})};break;case"ENUMS":t={brick:"forms.general-select",properties:(0,o.Z)((0,o.Z)((0,o.Z)({},r),n()),{},{mode:"multiple",options:[{label:"选项一",value:1},{label:"选项二",value:2}],placeholder:e.description,inputBoxStyle:{width:"100%"}})};break;case"DATE":case"TIME":t={brick:"forms.general-date-picker",properties:(0,o.Z)((0,o.Z)((0,o.Z)({},r),n()),{},{placeholder:e.description})};break;case"IP":t={brick:"forms.general-input",properties:(0,o.Z)((0,o.Z)((0,o.Z)({},r),n()),{},{placeholder:e.description,pattern:"((^s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))s*$)|(^s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:)))(%.+)?s*$))",message:{pattern:"输入字符不匹配IP格式"}})};break;case"JSON":t={brick:"forms.general-textarea",properties:(0,o.Z)({},r)};break;case"ARRAY":t={brick:"forms.general-select",properties:(0,o.Z)({},r)};break;case"STRUCTURE":case"STRUCTURE_ARRAY":t={brick:"forms.cmdb-instance-select-panel",properties:(0,o.Z)((0,o.Z)({},r),n())};break;default:t={brick:"forms.general-input",properties:(0,o.Z)((0,o.Z)((0,o.Z)({},r),n()),{},{placeholder:e.description})}}return t}(f);u||(u=v.brick),d=(0,o.Z)((0,o.Z)({},v.properties),d)}var h={brick:u,properties:d,iid:l,slot:c,events:i,context:s,children:Sr(a,t,r),[br]:r};return(0,p.hasOwnProperty)(e,"if")&&(h.if=e.if),h}function Sr(e,t,r){if(Array.isArray(e))return e.map((e=>wr(e,t,r)))}var Er=["blockingList","node","menuRequests","hasTrackingControls"],kr=["formData"];function Zr(e,t,r,n,o){return Ir.apply(this,arguments)}function Ir(){return Ir=(0,a.Z)((function*(e,t,r,n,a){var i=yield function(e,t){return wt.apply(this,arguments)}(t,r),s={blockingList:[],menuRequests:[]};switch(i){case"missed":break;case"unauthenticated":s.unauthenticated=!0;break;default:var c=s.route=i.route,l=(0,o.Z)((0,o.Z)({},r),{},{match:i.match});switch(l.ctxStore.define(c.context,l),l.pendingPermissionsPreCheck.push(ta(c,l)),c.type){case"redirect":var u;if("string"!=typeof(u="string"==typeof c.redirect?yield qo(c.redirect,l):(yield $e((0,o.Z)({transform:"redirect"},c.redirect),l)).redirect))throw console.error("Unexpected redirect result:",u),new Error("Unexpected type of redirect result: ".concat(typeof u));s.redirect={path:u};break;case"routes":s.menuRequests.push(Cr(c.menu,l)),Rr(s,yield Zr(e,c.routes,l,n,a));break;default:s.menuRequests.push(Cr(c.menu,l)),Rr(s,yield Ar(e,c.bricks,l,n,a))}}return s})),Ir.apply(this,arguments)}function Ar(e,t,r,n,o,a,i){return Or.apply(this,arguments)}function Or(){return(Or=(0,a.Z)((function*(e,t,r,n,o,a,i){var s={blockingList:[],menuRequests:[]};return(yield Promise.all(t.map(((t,i)=>Tr(e,t,r,n,o,i,a&&new Map(a)))))).forEach(((t,r)=>{!i&&t.hasTrackingControls&&n.memoizeControlNode(o,r,t.node,e),Rr(s,t)})),s}))).apply(this,arguments)}function Tr(e,t,r,n,o,a){return Pr.apply(this,arguments)}function Pr(){return Pr=(0,a.Z)((function*(e,t,r,n,s,c){var l,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Map,d={blockingList:[],menuRequests:[]};if(!t.brick)return t.template?console.error("Legacy templates are dropped in v3:",t):console.error("Invalid brick:",t),d;var v=t[kt],h=t[br],m=(0,o.Z)((0,o.Z)({},r),{},{tplStateStoreId:v,formStateStoreId:h});(0,p.hasOwnProperty)(t,Zt)&&(m.forEachItem=t[Zt]);var{context:g}=t;if(Array.isArray(g)&&g.length>0){var y=ot(m);at(y,"Defining context on bricks","check your brick:",t),y||m.ctxStore.define(g,m)}if(m.pendingPermissionsPreCheck.push(ta(t,m)),!(yield function(e,t){return ze.apply(this,arguments)}(t,m)))return d;var b=t.brick;if(b.startsWith(":")){!function(e){if(":forEach"!==e&&":if"!==e&&":switch"!==e)throw new Error('Unknown storyboard control node: "'.concat(e,'"'))}(b);var{dataSource:w}=t,S=function(){var r=(0,a.Z)((function*(){var r,o=yield qo(w,m),a=":forEach"===b?"":":switch"===b?String(o):o?"":"else",i=Mr(t.children,t.slots),c=i&&(0,p.hasOwnProperty)(i,a)&&(null===(r=i[a])||void 0===r?void 0:r.bricks);if(!Array.isArray(c))return d;switch(b){case":forEach":return Array.isArray(o)?function(e,t,r,n,o,a,i){return _r.apply(this,arguments)}(e,o,c,m,n,s,u):d;case":if":case":switch":return Ar(e,c,m,n,s,u,!0)}}));return function(){return r.apply(this,arguments)}}(),E=yield S(),{contextNames:k,stateNames:Z}=et(w);if(k||Z){E.hasTrackingControls=!0;var I=0,A=function(){var t=(0,a.Z)((function*(){var t=++I,r=yield S();r.blockingList.push(...[...m.tplStateStoreMap.values(),...m.formStateStoreMap.values()].map((e=>e.waitForAll())),...m.pendingPermissionsPreCheck),yield Promise.all(r.blockingList),I===t&&n.rerenderControlNode(s,c,r.node,e)}));return function(){return t.apply(this,arguments)}}(),O=(0,i.debounce)(A);if(k)for(var T of k)m.ctxStore.onChange(T,O);if(Z)for(var P of Z)lt(m,"STATE",': "'.concat(w,'"')).onChange(P,O)}return E}/\.tpl-/.test(b)&&!ct.get(b)&&(yield xr((0,f.loadBricksImperatively)([b],uo()),b,n.unknownBricks));var _=function(e,t){if(!e.includes(".")&&e.startsWith("tpl-")&&t){var r="".concat(t,".").concat(e);if(ct.get(r))return r}return!!ct.get(e)&&e}(b,null===(l=m.app)||void 0===l?void 0:l.id);if(_){var C,R=null!==(C=u.get(_))&&void 0!==C?C:0;if(R>=10)throw new Error('Maximum custom template stack overflowed: "'.concat(_,'"'));u.set(_,R+1)}else b.includes("-")&&!customElements.get(b)&&(b===yr?customElements.define(yr,class extends HTMLElement{get $$typeof(){return"form-renderer"}}):d.blockingList.push(xr((0,f.enqueueStableLoadBricks)([b],uo()),b,n.unknownBricks)));var M,x,B={tag:gr.BRICK,type:_||b,return:e,slotId:s,events:t.events,runtimeContext:m,portal:t.portal,iid:t.iid,ref:t.ref};if(d.node=B,b===yr){var L,N=null!==(L=t.properties)&&void 0!==L?L:{};({formData:M}=N),x=(0,de.Z)(N,kr)}else x=t.properties;var U=[],j=[],F=function(){var e=(0,a.Z)((function*(){B.properties=yield function(e,t,r){return tt.apply(this,arguments)}(x,m,j);var e=t[Et];if(e){var r;null!==(r=B.properties)&&void 0!==r||(B.properties={});var n=yield e;for(var[o,a]of Object.entries(n))B.properties[o]=a}return function(e,t){var r=function(t){var r=()=>{e.element&&nt(e.element,{[t.propName]:t.propValue},e.runtimeContext)};if(t.contextNames)for(var n of t.contextNames)e.runtimeContext.ctxStore.onChange(n,r);if(t.stateNames){var o=lt(e.runtimeContext,"STATE",': "'.concat(t.propValue,'"'));for(var a of t.stateNames)o.onChange(a,r)}if(t.formStateNames){var i=pt(e.runtimeContext,"FORM_STATE",': "'.concat(t.propValue,'"'));for(var s of t.formStateNames)i.onChange(s,r)}};for(var n of t)r(n)}(B,j),B.properties}));return function(){return e.apply(this,arguments)}}(),$=F();U.push($),n.registerBrickLifeCycle(B,t.lifeCycle);var K,D=t;_?D=hr(_,t,B,$):b===yr&&(D=function(e,t,r,n){var a,s,c="string"==typeof e?JSON.parse(e):e,l=(0,i.uniqueId)("form-state-"),u=(0,o.Z)((0,o.Z)({},r.runtimeContext),{},{formStateStoreId:l});delete u.forEachItem,delete u.tplStateStoreId;var d=new sr("FORM_STATE");u.formStateStoreMap.set(l,d),u.formStateStoreScope&&u.formStateStoreScope.push(d);var f=null!==(a=c.context)&&void 0!==a?a:[];f.some((e=>"params"===e.name))||f.push({name:"params"}),d.define(f,u,n);var v=wr(c.formSchema,c.fields,l);return"forms.general-form"===v.brick&&t.events&&(v.events=function(e,t){var r=null!=e?e:{};for(var[n,o]of Object.entries(t))r[n]=(0,p.hasOwnProperty)(r,n)?[r[n],o].flat():o;return r}(v.events,t.events)),"boolean"!=typeof(null===(s=t.properties)||void 0===s?void 0:s.renderRoot)||t.properties.renderRoot?(0,o.Z)((0,o.Z)({},t),{},{slots:void 0,children:[{brick:"basic-bricks.micro-view",properties:{style:{padding:"12px"}},slots:{content:{bricks:[v],type:"bricks"}}}]}):(0,o.Z)((0,o.Z)({},t),{},{slots:void 0,children:[v]})}(M,t,B,$)),D.portal&&(B.slotId=void 0),_?delete(K=(0,o.Z)({},m)).forEachItem:K=m;var W=function(){var e=(0,a.Z)((function*(){var e=Mr(D.children,D.slots);if(e){var t=yield Promise.all(Object.entries(e).map((e=>{var[t,r]=e;return"routes"!==r.type?Ar(B,r.bricks,K,n,t,u):Zr(B,r.routes,K,n,t)}))),r=(0,o.Z)((0,o.Z)({},d),{},{node:void 0,blockingList:[]});for(var a of t)Rr(r,a);r.node&&(B.child=r.node),Rr(d,(0,o.Z)((0,o.Z)({},r),{},{node:void 0}))}}));return function(){return e.apply(this,arguments)}}();return U.push(W()),yield Promise.all(U),d})),Pr.apply(this,arguments)}function _r(){return(_r=(0,a.Z)((function*(e,t,r,n,a,i,s){var c={blockingList:[],menuRequests:[]},l=yield Promise.all(t.map(((t,c)=>Promise.all(r.map(((r,l)=>Tr(e,r,(0,o.Z)((0,o.Z)({},n),{},{forEachItem:t}),a,i,c*l,s&&new Map(s))))))));for(var u of l.flat())Rr(c,u);return c}))).apply(this,arguments)}function Cr(e,t){if(e){if("brick"===e.type)throw console.error("Set menu with brick is dropped in v3:",e),new Error("Set menu with brick is dropped in v3");if("resolve"!==e.type)return qo(e,t);console.warn("Set menu with resolve is not supported in v3 yet:",e)}}function Rr(e,t){var{blockingList:r,node:n,menuRequests:o,hasTrackingControls:a}=t,i=(0,de.Z)(t,Er);if(e.blockingList.push(...r),e.menuRequests.push(...o),n)if(e.node){for(var s=e.node;s.sibling;)s=s.sibling;s.sibling=n}else e.node=n;Object.assign(e,i)}function Mr(e,t){var r=t;if(Array.isArray(e)&&!r)for(var n of(r={},e)){var o,a=null!==(o=n.slot)&&void 0!==o?o:"";(0,p.hasOwnProperty)(r,a)||(r[a]={type:"bricks",bricks:[]}),r[a].bricks.push(n)}return r}function xr(e,t,r){return"silent"===r?e.catch((e=>{console.error('Load brick "'.concat(t,'" failed:'),e)})):e}function Br(e){var t,{ref:r,runtimeContext:n,element:o}=e;if(r&&n.tplStateStoreId){var{hostBrick:a}=lt(n,"bindTemplateProxy"),i=a.tplHostMetadata;i.internalBricksByRef.set(r,e);var s=null===(t=i.proxy)||void 0===t?void 0:t.events;if(s){var c=function(e){if(u.ref===r){var t,n,i,s=t=>{t.bubbles&&t.stopPropagation(),a.element.dispatchEvent(new CustomEvent(e,{detail:t.detail,bubbles:t.bubbles,cancelable:t.cancelable,composed:t.composed}))},c=null!==(t=u.refEvent)&&void 0!==t?t:e;o.addEventListener(c,s),null!==(i=(n=o).$$proxyListeners)&&void 0!==i||(n.$$proxyListeners=[]),o.$$proxyListeners.push([c,s])}};for(var[l,u]of Object.entries(s))c(l)}}}function Lr(e){var{ref:t,runtimeContext:r,element:n}=e;if(r.tplStateStoreId&&t){var{hostBrick:o}=lt(r,"unbindTemplateProxy"),a=o.tplHostMetadata;for(var[i,s]of(a.internalBricksByRef.delete(t),null!==(c=n.$$proxyListeners)&&void 0!==c?c:[])){var c;n.removeEventListener(i,s)}delete n.$$proxyListeners}}function Nr(e){e.innerHTML=""}function Ur(e,t){for(var r=e.child,n=[];r;){var o=r.type;o.includes("-")&&!customElements.get(o)&&console.error("Undefined custom element: ".concat(o)),"basic-bricks.script-brick"===o&&console.warn("`basic-bricks.script-brick` is deprecated, please take caution when using it");var a=t&&r===e.child?t:document.createElement(o);if(r.element=a,r.slotId&&a.setAttribute("slot",r.slotId),r.iid&&(a.dataset.iid=r.iid),rt(a,r.properties),Ft(a,r.events,r.runtimeContext),r.tplHostMetadata&&(a.$$tplStateStore=lt({tplStateStoreId:r.tplHostMetadata.tplStateStoreId,tplStateStoreMap:r.runtimeContext.tplStateStoreMap},"mount")),Br(r),r.portal?n.push(a):r.return&&(r.return.childElements||(r.return.childElements=[]),r.return.childElements.push(a)),r.child)r=r.child;else if(r.sibling)r=r.sibling;else{for(var i,s=r.return;s;){var c;if(s.childElements)s.tag===gr.ROOT?(null===(c=s.container)||void 0===c||c.append(...s.childElements),n.length>0&&("function"==typeof s.createPortal?s.createPortal():s.createPortal).append(...n)):s.element.append(...s.childElements),s.childElements=void 0;if(s.sibling)break;s=s.return}r=null===(i=s)||void 0===i?void 0:i.sibling}}}var jr,Fr=["onMount","onUnmount","onMediaChange","onScrollIntoView"],$r=["onBeforePageLoad","onPageLoad","onPageLeave","onBeforePageLeave","onAnchorLoad","onAnchorUnload"],Kr=new WeakMap,Dr=new WeakMap,Wr=new WeakMap,Vr=new WeakMap,Hr=new WeakSet,qr=new WeakSet,Gr=new WeakSet,zr=new WeakSet;class Jr{constructor(e,t){var r;(0,Se.Z)(this,zr),(0,Se.Z)(this,Gr),(0,Se.Z)(this,qr),(0,Se.Z)(this,Hr),(0,It.Z)(this,"scope",void 0),(0,It.Z)(this,"unknownBricks",void 0),(0,h.Z)(this,Kr,{writable:!0,value:{onBeforePageLoad:[],onPageLoad:[],onPageLeave:[],onBeforePageLeave:[],onAnchorLoad:[],onAnchorUnload:[],onMediaChange:[],onScrollIntoView:[],onMount:[],onUnmount:[]}}),(0,h.Z)(this,Dr,{writable:!0,value:new Map}),(0,h.Z)(this,Wr,{writable:!0,value:void 0}),(0,h.Z)(this,Vr,{writable:!0,value:void 0}),this.scope=e,this.unknownBricks=null!==(r=null==t?void 0:t.unknownBricks)&&void 0!==r?r:"throw"}registerBrickLifeCycle(e,t){if(t){var r=[...Fr,..."page"===this.scope?$r:[]];for(var n of r){var o=t[n];o&&(0,m.Z)(this,Kr)[n].push({brick:e,handlers:o})}(0,i.isEmpty)(t.useResolves)||console.error("`lifeCycle.useResolves` is dropped in v3:",t)}}memoizeControlNode(e,t,r,n){(0,m.Z)(this,Vr)||(0,le.Z)(this,Vr,new WeakMap);var o="".concat(null!=e?e:"",".").concat(t),a=(0,m.Z)(this,Vr).get(n);a||(a=new Map,(0,m.Z)(this,Vr).set(n,a)),a.set(o,{node:r,last:tn(r),lastNormal:rn(r),lastPortal:nn(r)})}rerenderControlNode(e,t,r,n){var o,a,i,s,c,l="".concat(null!=e?e:"",".").concat(t),u=(0,m.Z)(this,Vr).get(n).get(l),{node:p,last:d,lastNormal:f,lastPortal:v}=u,h=null!==(o=null==f||null===(a=f.element)||void 0===a?void 0:a.nextSibling)&&void 0!==o?o:null,g=null!==(i=null==v||null===(s=v.element)||void 0===s?void 0:s.nextSibling)&&void 0!==i?i:null,y=tn(r);u.node=r,u.last=y,u.lastNormal=rn(r),u.lastPortal=nn(r);for(var b=n.child;b&&b!==d;){if(b.sibling===p){c=b;break}b=b.sibling}var w=document.createDocumentFragment(),S=document.createDocumentFragment(),E={tag:gr.ROOT,container:w,createPortal:S,child:r};for(b=r;b;)b.return=E,b=b.sibling;var k,Z,I=on(p,d);for((0,Ee.Z)(this,Hr,Yr).call(this,I),Ur(E),c?c.sibling=r:n.child=r,y&&(y.sibling=null==d?void 0:d.sibling),b=r;b;)b.return=n,b=b.sibling;if(n.tag===gr.ROOT?null===(k=n.container)||void 0===k||k.insertBefore(w,h):null===(Z=n.element)||void 0===Z||Z.insertBefore(w,h),S.childNodes.length>0){for(var A,O=r;O&&O.return;)O=O.return;if((null===(A=O)||void 0===A?void 0:A.tag)!==gr.ROOT)throw new Error("Cannot find render root node");("function"==typeof O.createPortal?O.createPortal():O.createPortal).insertBefore(S,g)}var T=on(r,y);(0,Ee.Z)(this,qr,Qr).call(this,T)}dispose(){for(var e of Object.values((0,m.Z)(this,Kr)))e.length=0;for(var t of(0,m.Z)(this,Dr).values()){for(var r of t)r.disconnect();t.length=0}(0,m.Z)(this,Dr).clear(),(0,m.Z)(this,Wr)&&(ne.removeEventListener("change",(0,m.Z)(this,Wr)),(0,le.Z)(this,Wr,void 0)),(0,le.Z)(this,Vr,void 0)}dispatchBeforePageLoad(){(0,Ee.Z)(this,Gr,Xr).call(this,"onBeforePageLoad",new CustomEvent("page.beforeLoad"))}dispatchPageLoad(){var e=new CustomEvent("page.load");(0,Ee.Z)(this,Gr,Xr).call(this,"onPageLoad",e),window.dispatchEvent(e)}dispatchBeforePageLeave(e){(0,Ee.Z)(this,Gr,Xr).call(this,"onBeforePageLeave",new CustomEvent("page.beforeLeave",{detail:e}))}dispatchPageLeave(){(0,Ee.Z)(this,Gr,Xr).call(this,"onPageLeave",new CustomEvent("page.leave"))}dispatchAnchorLoad(){var{hash:e}=we().location;e&&"#"!==e?(0,Ee.Z)(this,Gr,Xr).call(this,"onAnchorLoad",new CustomEvent("anchor.load",{detail:{hash:e,anchor:e.substring(1)}})):(0,Ee.Z)(this,Gr,Xr).call(this,"onAnchorUnload",new CustomEvent("anchor.unload"))}initializeScrollIntoView(){for(var{brick:e,handlers:t}of(0,m.Z)(this,Kr).onScrollIntoView)(0,Ee.Z)(this,zr,en).call(this,e,t)}initializeMediaChange(){(0,le.Z)(this,Wr,(e=>{(0,Ee.Z)(this,Gr,Xr).call(this,"onMediaChange",new CustomEvent("media.change",{detail:T(e.detail)}))})),ne.addEventListener("change",(0,m.Z)(this,Wr))}dispatchOnMount(){(0,Ee.Z)(this,Gr,Xr).call(this,"onMount",new CustomEvent("mount"))}dispatchOnUnmount(){(0,Ee.Z)(this,Gr,Xr).call(this,"onUnmount",new CustomEvent("unmount"))}}function Yr(e){var t=[...Fr,..."page"===this.scope?$r:[]],r=[];for(var n of t){var o=(0,i.remove)((0,m.Z)(this,Kr)[n],(t=>e.has(t.brick)));"onUnmount"===n&&r.push(...o)}for(var a of e){var s,c,l=(0,m.Z)(this,Dr).get(a);if(null!=l&&l.length){for(var u of l)u.disconnect();l.length=0,(0,m.Z)(this,Dr).delete(a)}Lr(a),null===(s=a.element)||void 0===s||delete s.$$tplStateStore,null===(c=a.element)||void 0===c||c.remove()}var p=new CustomEvent("unmount");for(var{brick:d,handlers:f}of r)Wt(f,d.runtimeContext,d)(p)}function Qr(e){var t=new CustomEvent("mount");for(var{brick:r,handlers:n}of(0,m.Z)(this,Kr).onMount)e.has(r)&&Wt(n,r.runtimeContext,r)(t);for(var{brick:o,handlers:a}of(0,m.Z)(this,Kr).onScrollIntoView)e.has(o)&&(0,Ee.Z)(this,zr,en).call(this,o,a)}function Xr(e,t){for(var{brick:r,handlers:n}of(0,m.Z)(this,Kr)[e])Wt(n,r.runtimeContext,r)(t)}function en(e,t){var r,n=null!==(r=t.threshold)&&void 0!==r?r:.1,o=new IntersectionObserver(((r,o)=>{r.forEach((r=>{r.isIntersecting&&r.intersectionRatio>=n&&(Wt(t.handlers,e.runtimeContext,e)(new CustomEvent("scroll.into.view")),o.disconnect())}))}),{threshold:n});o.observe(e.element);var a=(0,m.Z)(this,Dr).get(e);a||(a=[],(0,m.Z)(this,Dr).set(e,a)),a.push(o)}function tn(e){for(var t=e;null!==(r=t)&&void 0!==r&&r.sibling;){var r;t=t.sibling}return t}function rn(e){for(var t,r=e;r;)r.portal||(t=r),r=r.sibling;return t}function nn(e){for(var t,r=e;r;)if(r.portal&&(t=r),r.child)r=r.child;else if(r.sibling)r=r.sibling;else{for(var n,o=r.return;o&&!o.sibling;)o=o.return;r=null===(n=o)||void 0===n?void 0:n.sibling}return t}function on(e,t){for(var r=new Set,n=e;n;)if(r.add(n),n.child)n=n.child;else{if(n===t)break;if(n.sibling)n=n.sibling;else{for(var o,a=n.return;a&&a!==t&&!a.sibling;)a=a.return;if(a===t)break;n=null===(o=a)||void 0===o?void 0:o.sibling}}return r}function an(){if(!jr){if(jr={isInIframe:!1,isInIframeOfSameSite:!1,isInIframeOfNext:!1,isInIframeOfVisualBuilder:!1,isInIframeOfLegacyConsole:!1},window!==window.parent){jr.isInIframe=!0;try{if(window.origin===window.parent.origin){jr.isInIframeOfSameSite=!0;var e="/next/"===W(),t=window.parent.location.pathname,r=t.startsWith("/next/");jr.isInIframeOfNext=0==(Number(e)^Number(r)),jr.isInIframeOfVisualBuilder=t.startsWith("".concat(r?"/next":"","/visual-builder/")),jr.isInIframeOfLegacyConsole=e&&!r}}catch(e){}}Object.freeze(jr)}return jr}var sn,cn=new WeakSet;function ln(e){if((0,p.isObject)(e)&&!un(e))if(cn.add(e),Array.isArray(e))e.forEach(ln);else{var t=Object.getPrototypeOf(e);t&&t.constructor!==Object||Object.values(e).forEach(ln)}}function un(e){return cn.has(e)}function pn(e){var t;if(!e.$$registerCustomTemplateProcessed){e.$$registerCustomTemplateProcessed=!0;var r=null===(t=e.meta)||void 0===t?void 0:t.customTemplates;if(Array.isArray(r))for(var n of r){var o=n.name.includes(".")?n.name:"".concat(e.app.id,".").concat(n.name);ct.define(o,n)}}}function dn(){return dn=(0,a.Z)((function*(e){if(!e.$$fulfilled)return e.$$fulfilling||(e.$$fulfilling=function(e){return fn.apply(this,arguments)}(e)),e.$$fulfilling})),dn.apply(this,arguments)}function fn(){return(fn=(0,a.Z)((function*(e){var t;yield null==no||null===(t=no.fulfilStoryboard)||void 0===t?void 0:t.call(no,e),w(e),Object.assign(e,{$$fulfilled:!0,$$fulfilling:null})}))).apply(this,arguments)}var vn=function(){var e=(0,a.Z)((function*(e,t){return(yield c.http.post("api/gateway/micro_app_standalone.runtime.SearchMicroAppStandalone/api/v1/micro_app_standalone/search",e,t)).data}));return function(t,r){return e.apply(this,arguments)}}();const hn=(e,t,r)=>{Zn(r);const n=((e,t)=>{const r=gn(e),n=gn(t),o=r.pop(),a=n.pop(),i=Sn(r,n);return 0!==i?i:o&&a?Sn(o.split("."),a.split(".")):o||a?o?-1:1:0})(e,t);return En[r].includes(n)},mn=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,gn=e=>{if("string"!=typeof e)throw new TypeError("Invalid argument expected string");const t=e.match(mn);if(!t)throw new Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},yn=e=>"*"===e||"x"===e||"X"===e,bn=e=>{const t=parseInt(e,10);return isNaN(t)?e:t},wn=(e,t)=>{if(yn(e)||yn(t))return 0;const[r,n]=((e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t])(bn(e),bn(t));return r>n?1:r<n?-1:0},Sn=(e,t)=>{for(let r=0;r<Math.max(e.length,t.length);r++){const n=wn(e[r]||"0",t[r]||"0");if(0!==n)return n}return 0},En={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]},kn=Object.keys(En),Zn=e=>{if("string"!=typeof e)throw new TypeError("Invalid operator type, expected string but got "+typeof e);if(-1===kn.indexOf(e))throw new Error(`Invalid operator, expected one of ${kn.join("|")}`)};function In(e,t){return function(r,n,o){if(n.name===e){var a=o[o.length-1],i=o[o.length-2];if("CallExpression"===(null==i?void 0:i.node.type)&&"callee"===(null==i?void 0:i.key)&&"MemberExpression"===(null==a?void 0:a.node.type)&&"object"===a.key&&(a.node.computed?"Literal"===a.node.property.type&&a.node.property.value===t:"Identifier"===a.node.property.type&&a.node.property.name===t)){var s=i.node.arguments;if(s.length>0){var c=s[0];"Literal"===c.type&&"string"==typeof c.value?r.usedArgs.add(c.value):r.hasNonStaticUsage=!0}}}}}var An=In("APP","getMenu"),On=In("INSTALLED_APPS","has"),Tn=new Map,Pn=new Map;function _n(e,t){var r=ho(e);if(!r&&window.STANDALONE_MICRO_APPS&&(r=Pn.get(e)),!r||"running"===r.installStatus)return!1;if(!t||!r.currentVersion)return!0;var n=t.match(/^([><]=?|=)(.*)$/);try{if(!n)throw new TypeError("Invalid match version: ".concat(t));return hn(r.currentVersion,n[2],n[1])}catch(e){console.error(e)}return!1}var Cn=new WeakMap,Rn=new WeakMap,Mn=new WeakMap,xn=new WeakMap,Bn=new WeakMap,Ln=new WeakMap,Nn=new WeakMap,Un=new WeakMap,jn=new WeakMap,Fn=new WeakMap,$n=new WeakMap,Kn=new WeakMap,Dn=new WeakSet,Wn=new WeakSet,Vn=new WeakSet,Hn=new WeakSet;class qn{constructor(e){(0,Se.Z)(this,Hn),(0,Se.Z)(this,Vn),(0,Se.Z)(this,Wn),(0,Se.Z)(this,Dn),(0,h.Z)(this,Cn,{writable:!0,value:void 0}),(0,h.Z)(this,Rn,{writable:!0,value:!1}),(0,h.Z)(this,Mn,{writable:!0,value:void 0}),(0,h.Z)(this,xn,{writable:!0,value:void 0}),(0,h.Z)(this,Bn,{writable:!0,value:void 0}),(0,h.Z)(this,Ln,{writable:!0,value:void 0}),(0,h.Z)(this,Nn,{writable:!0,value:new Set}),(0,h.Z)(this,Un,{writable:!0,value:0}),(0,h.Z)(this,jn,{writable:!0,value:void 0}),(0,h.Z)(this,Fn,{writable:!0,value:void 0}),(0,h.Z)(this,$n,{writable:!0,value:void 0}),(0,h.Z)(this,Kn,{writable:!0,value:void 0}),(0,le.Z)(this,Cn,e);var t=we();window.addEventListener("beforeunload",(e=>{(0,Ee.Z)(this,Dn,Gn).call(this,{})?(e.preventDefault(),e.returnValue=""):delete e.returnValue})),t.block(((e,t)=>(0,Ee.Z)(this,Dn,Gn).call(this,{location:e,action:t})))}getRenderId(){return(0,m.Z)(this,jn)}getRuntimeContext(){return(0,m.Z)(this,Bn)}getRecentApps(){return{currentApp:(0,m.Z)(this,Fn),previousApp:(0,m.Z)(this,$n)}}getNavConfig(){return(0,m.Z)(this,Kn)}bootstrap(){window.AbortController&&(sn=new AbortController,c.http.interceptors.request.use((e=>{var t;return(0,o.Z)((0,o.Z)({},e),{},{options:(0,o.Z)((0,o.Z)({},e.options),{},{signal:null!==(t=e.options)&&void 0!==t&&t.noAbortOnRouteChange?null:sn.signal})})})));var e=we();return(0,le.Z)(this,Mn,e.location),e.listen(((e,t)=>{var r,n,a,i=!1,s={hash:void 0,state:void 0};if(void 0!==e.key&&("POP"!==t||void 0!==(0,m.Z)(this,Mn).key&&!1!==(null===(r=(0,m.Z)(this,Mn).state)||void 0===r?void 0:r.notify))||(s.key=void 0),((0,pe.locationsAreEqual)((0,o.Z)((0,o.Z)({},(0,m.Z)(this,Mn)),s),(0,o.Z)((0,o.Z)({},e),s))||"POP"!==t&&!1===(null===(n=e.state)||void 0===n?void 0:n.notify))&&(i=!0),i)(0,le.Z)(this,Mn,e);else{if(sn&&(sn.abort(),sn=new AbortController),(0,le.Z)(this,Mn,e),null===(a=(0,m.Z)(this,Ln))||void 0===a||a.dispatchPageLeave(),"POP"===t&&ve(fe((0,m.Z)(this,Cn),e.pathname)))return void window.location.reload();(0,m.Z)(this,Rn)?(0,le.Z)(this,xn,e):(0,Ee.Z)(this,Vn,Jn).call(this,e).catch(Ut)}})),(0,Ee.Z)(this,Vn,Jn).call(this,e.location)}}function Gn(e){var t,r=we(),n=r.getBlockMessage();null===(t=(0,m.Z)(this,Ln))||void 0===t||t.dispatchBeforePageLeave(e);var o=r.getBlockMessage();return!n&&o&&r.unblock(),o}function zn(e,t,r){var n,o;if((0,le.Z)(this,Un,(n=(0,m.Z)(this,Un),o=n++,n)),o>10){var a='Infinite redirect detected: from "'.concat(r.pathname).concat(r.search).concat(r.hash,'" to "').concat(e,'"');throw new Error(a)}we().replace(e,t)}function Jn(e){return Yn.apply(this,arguments)}function Yn(){return(Yn=(0,a.Z)((function*(e){(0,le.Z)(this,Rn,!0);try{yield(0,Ee.Z)(this,Hn,Qn).call(this,e)}finally{if((0,le.Z)(this,Rn,!1),(0,m.Z)(this,xn)){var t=(0,m.Z)(this,xn);(0,le.Z)(this,xn,void 0),yield(0,Ee.Z)(this,Vn,Jn).call(this,t)}}}))).apply(this,arguments)}function Qn(e){return Xn.apply(this,arguments)}function Xn(){return Xn=(0,a.Z)((function*(e){var t;(0,le.Z)(this,jn,(0,i.uniqueId)("render-id-1")),cn=new WeakSet,Fe.clear(),Ae.clear(),we().unblock();var r=fe((0,m.Z)(this,Cn),e.pathname),n=null===(t=(0,m.Z)(this,Bn))||void 0===t?void 0:t.app;null!=r&&r.app&&(yield function(e){return dn.apply(this,arguments)}(r));var a,l=(0,le.Z)(this,Fn,null==r?void 0:r.app),u=n&&l?n.id!==l.id:n!==l,p=io().getFeatureFlags(),d=(0,m.Z)(this,Ln),v=(t,r)=>{(0,m.Z)(this,Nn).add(d),(0,Ee.Z)(this,Wn,zn).call(this,t,r,e)},h=()=>{var t=p["sso-enabled"]?"/sso-auth/login":"/auth/login";v(t,{from:e})},g=document.querySelector("#main-mount-point"),y=document.querySelector("#portal-mount-point"),b={tag:gr.ROOT,container:g,createPortal:y},w=()=>{for(var e of(Nr(g),Nr(y),(0,m.Z)(this,Nn).add(d),(0,m.Z)(this,Nn)))e&&(e.dispatchOnUnmount(),e.dispose());(0,m.Z)(this,Nn).clear(),M(l&&(U()[l.id]||l.theme)||"light"),F("default"),u&&((0,le.Z)(this,$n,n),window.dispatchEvent(new CustomEvent("app.change",{detail:{previousApp:n,currentApp:l}})))};if(l){var S,E;!function(e){if(window.STANDALONE_MICRO_APPS&&!window.NO_AUTH_GUARD){var t=function(e){var t,r={usedArgs:new Set},{customTemplates:n,menus:o}=null!==(t=e.meta)&&void 0!==t?t:{};return(0,s.traverseStoryboardExpressions)([e.routes,n,o],((e,t)=>{On(r,e,t)}),"INSTALLED_APPS"),[...r.usedArgs]}(e),r=[];for(var n of t)Tn.has(n)||ho(n)||r.push(n);if(0===r.length)return;var a=vn({query:{appId:{$in:r}},fields:["appId","currentVersion","installStatus"]}).catch((e=>{console.error("Get off site standalone micro-apps failed",e)})),i=function(e){Tn.set(e,a.then((t=>{var r,n=null==t||null===(r=t.list)||void 0===r?void 0:r.find((t=>t.appId===e)),a=n?(0,o.Z)((0,o.Z)({},n),{},{id:e}):void 0;return Pn.set(e,a),a})))};for(var c of r)i(c)}}(r);var k=(0,le.Z)(this,Bn,{app:l,location:e,query:new URLSearchParams(e.search),flags:p,sys:(0,o.Z)((0,o.Z)({},la()),an()),ctxStore:new sr("CTX"),pendingPermissionsPreCheck:[ea(r)],tplStateStoreMap:new Map,formStateStoreMap:new Map}),Z=(0,le.Z)(this,Ln,new Jr("page"));(0,le.Z)(this,Kn,void 0),pn(r),Y(null===(S=r.meta)||void 0===S?void 0:S.functions,l),a=null===(E=r.meta)||void 0===E?void 0:E.contracts,Oe(a,Ie);var I,A=!1;try{if((I=yield Zr(b,function(e){if(window.parent===window)return e;var t=e,r=(0,i.findLastIndex)(t,(e=>e.path.startsWith("${APP.homepage}/_dev_only_/template-preview/")));t=[...t.slice(0,r+1),{path:"${APP.homepage}/_dev_only_/template-preview/:templateId",bricks:[{brick:"span"}],menu:!1,exact:!0},...t.slice(r+1)];var n=(0,i.findLastIndex)(t,(e=>e.path.startsWith("${APP.homepage}/_dev_only_/snippet-preview/")));return[...t.slice(0,n+1),{path:"${APP.homepage}/_dev_only_/snippet-preview/:snippetId",bricks:[{brick:"span"}],menu:!1,exact:!0},...t.slice(n+1)]}(r.routes),k,Z)).unauthenticated)return void h();if(I.redirect)return void v(I.redirect.path,I.redirect.state);(0,le.Z)(this,Un,0),(0,f.flushStableLoadBricks)(),yield Promise.all([...I.blockingList,...[k.ctxStore,...k.tplStateStoreMap.values(),...k.formStateStoreMap.values()].map((e=>e.waitForAll())),...k.pendingPermissionsPreCheck]);var O=yield Promise.all(I.menuRequests);(0,le.Z)(this,Kn,function(e){var t={breadcrumb:[]};for(var r of e)if(r){var{breadcrumb:n}=r;n&&(n.overwrite?t.breadcrumb=n.items:t.breadcrumb.push(...n.items))}return t}(O))}catch(e){if(console.error("Router failed:",e),xt(e)&&!window.NO_AUTH_GUARD)return void h();if(e instanceof c.HttpAbortError)return void(0,m.Z)(this,Nn).add(d);A=!0,I={node:{tag:gr.BRICK,type:"div",properties:{textContent:Mt(e)},runtimeContext:null,return:b},blockingList:[],menuRequests:[]}}if(b.child=I.node,w(),I.route&&"routes"!==I.route.type||A)return A||Z.dispatchBeforePageLoad(),L(),K(),Ur(b),window.scrollTo(0,0),void(A||(Z.dispatchPageLoad(),Z.dispatchAnchorLoad(),Z.dispatchOnMount(),Z.initializeScrollIntoView(),Z.initializeMediaChange()))}else{if(!window.NO_AUTH_GUARD&&!pa())return void h();w()}L(),K();var T={tag:gr.BRICK,type:"div",properties:{textContent:"Page not found"},runtimeContext:null,return:b};b.child=T,Ur(b),window.scrollTo(0,0)})),Xn.apply(this,arguments)}var eo,to,ro,no,oo="undefined"!=typeof BRICK_PACKAGES?BRICK_PACKAGES:[];function ao(e){if(eo)throw new Error("Cannot create multiple runtimes");return no=null==e?void 0:e.hooks,(0,b.initializeI18n)(_t,Ct),ue.locale(b.i18n.language),b.i18n.on("languageChanged",(()=>{ue.locale(b.i18n.language)})),be(),eo=new lo}function io(){return eo}var so=new WeakMap,co=new WeakMap;class lo{constructor(){(0,h.Z)(this,so,{writable:!0,value:!1}),(0,h.Z)(this,co,{writable:!0,value:!1})}initialize(e){if((0,m.Z)(this,so))throw new Error("The runtime cannot be initialized more than once");var t;(0,le.Z)(this,so,!0),function(e){if(Array.isArray(e.storyboards)){var t=function(){if(r.locales){var e="tmp/".concat(r.id);Object.entries(r.locales).forEach((t=>{var[r,n]=t;b.i18n.addResourceBundle(r,e,n)})),r.localeName=b.i18n.getFixedT(null,e)("name",r.name),Object.keys(r.locales).forEach((t=>{b.i18n.removeResourceBundle(t,e)}))}else r.localeName=r.name};for(var{app:r}of e.storyboards)t()}(0,p.isObject)(e.settings)&&(0,p.deepFreeze)(e.settings),e.brickPackages&&(0,p.deepFreeze)(e.brickPackages)}(e),to=e,t="shoelace.show-notification",(0,this.loadBricks)([t]).then((()=>{Lt=document.createElement(t)}),(e=>{console.error("Load notification service failed:",e)})),function(e,t){t([e]).then((()=>{St=document.createElement(e)}),(e=>{console.error("Load dialog service failed:",e)}))}("shoelace.show-dialog",this.loadBricks)}bootstrap(e){var t=this;return(0,a.Z)((function*(){if(e&&t.initialize(e),(0,m.Z)(t,co))throw new Error("The runtime cannot be bootstrapped more than once");(0,le.Z)(t,co,!0),ro=new qn(to.storyboards),yield ro.bootstrap()}))()}getRecentApps(){var e,t;return null!==(e=null===(t=ro)||void 0===t?void 0:t.getRecentApps())&&void 0!==e?e:{}}getCurrentApp(){var e;return null===(e=ro)||void 0===e?void 0:e.getRecentApps().currentApp}getFeatureFlags(){var e,t,r,n,a,i;return(0,o.Z)((0,o.Z)((0,o.Z)({},null===(e=to)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.featureFlags),null===(r=ro)||void 0===r||null===(n=r.getRecentApps().currentApp)||void 0===n||null===(a=n.config)||void 0===a||null===(i=a.settings)||void 0===i?void 0:i.featureFlags),{},{"migrate-to-brick-next-v3":!0})}getMiscSettings(){var e,t,r,n,a,i;return(0,o.Z)((0,o.Z)({},null===(e=to)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.misc),null===(r=ro)||void 0===r||null===(n=r.getRecentApps().currentApp)||void 0===n||null===(a=n.config)||void 0===a||null===(i=a.settings)||void 0===i?void 0:i.misc)}getBrandSettings(){var e,t;return(0,o.Z)({base_title:"DevOps 管理专家"},null===(e=to)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.brand)}getLaunchpadSettings(){var e,t;return(0,o.Z)({columns:7,rows:4},null===(e=to)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.launchpad)}getDesktops(){var e,t;return null!==(e=null===(t=to)||void 0===t?void 0:t.desktops)&&void 0!==e?e:[]}getLaunchpadSiteMap(){var e,t;return null!==(e=null===(t=to)||void 0===t?void 0:t.siteSort)&&void 0!==e?e:[]}toggleLaunchpadEffect(e){document.body.classList.toggle("launchpad-open",e)}applyPageTitle(e){var t=this.getBrandSettings().base_title;document.title=e?"".concat(e," - ").concat(t):t}getNavConfig(){var e;return null===(e=ro)||void 0===e?void 0:e.getNavConfig()}loadBricks(e){return(0,f.loadBricksImperatively)(e,uo())}}function uo(){var e,t;return null!==(e=null===(t=to)||void 0===t?void 0:t.brickPackages)&&void 0!==e?e:oo}function po(){var e;return null===(e=ro)||void 0===e?void 0:e.getRenderId()}function fo(){var e;return null===(e=ro)||void 0===e?void 0:e.getRuntimeContext()}function vo(e){var t,r;return null===(t=to)||void 0===t||null===(r=t.storyboards)||void 0===r?void 0:r.find((t=>t.app.id===e))}function ho(e){var t;return null===(t=vo(e))||void 0===t?void 0:t.app}var mo=new Map,go=new Proxy(Object.freeze({}),{get:(e,t)=>mo.get(t)});function yo(e,t,r){if(mo.has(e))throw new Error('Widget functions of "'.concat(e,'" already registered'));var{storyboardFunctions:n,registerStoryboardFunctions:o}=z({widgetId:e,widgetVersion:r});mo.set(e,n),o(t)}var bo=function(){var e=(0,a.Z)((function*(e,t,r){return(yield c.http.post("api/gateway/cmdb.instance.PostSearch/object/".concat(e,"/instance/_search"),t,r)).data}));return function(t,r,n){return e.apply(this,arguments)}}(),wo=Symbol("appId"),So=Symbol("menuI18nNamespace"),Eo=Symbol("overrideApp");function ko(){return(ko=(0,a.Z)((function*(e,t,r){if(e.dynamicItems&&e.itemsResolve){var n=e.app[0].appId,a=t;if(n!==t.app.id){var i=window.STANDALONE_MICRO_APPS?e.overrideApp:ho(n);a=(0,o.Z)((0,o.Z)({},t),{},{overrideApp:i,appendI18nNamespace:r.get(e)})}var s=yield $e((0,o.Z)({transform:"items"},e.itemsResolve),a);e.items=s.items}}))).apply(this,arguments)}function Zo(){return Zo=(0,a.Z)((function*(e,t){var r=e.find((e=>"inject"!==e.type));if(r){var n=[],a=new Map,i=new WeakMap,s=function*(){if(c.i18n){var e=S("menu","".concat(c.menuId,"~").concat(c.app[0].appId,"+").concat(c.instanceId));Object.entries(c.i18n).forEach((t=>{var[r,n]=t;b.i18n.addResourceBundle(r,e,n)})),i.set(c,e)}};for(var c of e)yield*s();for(var l of(yield Promise.all(e.map((e=>function(e,t,r){return ko.apply(this,arguments)}(e,t,i)))),e)){var u;if(null!==(u=l.items)&&void 0!==u&&u.length)if("inject"===l.type&&l.injectMenuGroupId){var p=a.get(l.injectMenuGroupId);p||(p=[],a.set(l.injectMenuGroupId,p)),p.push(l)}else n.push(l)}return(0,o.Z)((0,o.Z)({},r),{},{items:n.flatMap((e=>Io(e.items,e,a,i))),[So]:i.get(r),[Eo]:r.overrideApp})}})),Zo.apply(this,arguments)}function Io(e,t,r,n){return null==e?void 0:e.map((e=>{var a,i=e.groupId&&r.get(e.groupId);return i&&r.delete(e.groupId),(0,o.Z)((0,o.Z)({},e),{},{children:(null!==(a=Io(e.children,t,r,n))&&void 0!==a?a:[]).concat(i?i.flatMap((e=>Io(e.items,e,r,n))):[]),[wo]:t.app[0].appId,[So]:n.get(t),[Eo]:t.overrideApp})}))}function Ao(e){return(0,i.sortBy)(e,(e=>{var t;return null!==(t=e.sort)&&void 0!==t?t:-1/0}))}var Oo=["children"];function To(e,t,r){var n=r;if(t!==r.app.id){var a=window.STANDALONE_MICRO_APPS?e[Eo]:ho(t);n=(0,o.Z)((0,o.Z)({},r),{},{overrideApp:a,appendI18nNamespace:e[So]})}return qo(e,n,{ignoreSymbols:!0})}function Po(e,t){return Promise.all(e.map(function(){var e=(0,a.Z)((function*(e){var{children:r}=e,n=(0,de.Z)(e,Oo),[a,i]=yield Promise.all([To(n,n[wo],t),r&&(yield Po(r,t))]);return(0,o.Z)((0,o.Z)({},a),{},{children:i})}));return function(t){return e.apply(this,arguments)}}()))}var _o=function(){var e=(0,a.Z)((function*(e,t,r,n){return(yield c.http.get("api/gateway/cmdb.instance.GetDetail/object/".concat(e,"/instance/").concat(t),(0,o.Z)((0,o.Z)({},n),{},{params:r}))).data}));return function(t,r,n,o){return e.apply(this,arguments)}}(),Co=new Map;function Ro(e){return Mo.apply(this,arguments)}function Mo(){return(Mo=(0,a.Z)((function*(e){if(e.title||(0,i.isEmpty)(e.titleDataSource))return e.title;var t=JSON.stringify(e.titleDataSource);if(Co.has(t))return Co.get(t);var r,{objectId:n,instanceId:o,attributeId:a}=e.titleDataSource,s=null!=a?a:"name",c=yield _o(n,o,{fields:s});if("#showKey"===a&&Array.isArray(c[s])){var[l,...u]=c[s];r=u.length>0?"".concat(l,"(").concat(u.join(","),")"):String(l)}else r=String(c[s]);return Co.set(t,r),r}))).apply(this,arguments)}var xo=["items","app"],Bo=new Map,Lo=new Map;function No(e){return Lo.get(e)}function Uo(){return Uo=(0,a.Z)((function*(e,t){var r=window.STANDALONE_MICRO_APPS?function(e,t){var r,n,a,i,s=vo(t);return(null!==(r=null!==(n=null===(a=s.meta)||void 0===a?void 0:a.injectMenus)&&void 0!==n?n:null===(i=s.meta)||void 0===i?void 0:i.menus)&&void 0!==r?r:[]).filter((t=>t.menuId===e)).map((e=>{var r,n;return(0,o.Z)((0,o.Z)({},e),null!==(r=e.app)&&void 0!==r&&null!==(n=r[0])&&void 0!==n&&n.appId?{}:{app:[{appId:t}]})}))}(e,t.app.id):(yield bo("EASYOPS_STORYBOARD_MENU",{page:1,page_size:200,fields:{menuId:!0,title:!0,icon:!0,link:!0,titleDataSource:!0,defaultCollapsed:!0,defaultCollapsedBreakpoint:!0,type:!0,injectMenuGroupId:!0,dynamicItems:!0,itemsResolve:!0,items:!0,i18n:!0,"items.children":!0,"app.appId":!0},query:{menuId:{$eq:e},app:{$size:{$gt:0}}}})).list,n=yield function(e,t){return Zo.apply(this,arguments)}(r,t);if(!n)throw new Error("Menu not found: ".concat(e));!function(e){e.items=Ao(e.items).map((e=>(0,o.Z)((0,o.Z)({},e),{},{children:Ao(e.children)})))}(n);var{items:a,app:s}=n,c=(0,de.Z)(n,xo),l=(0,o.Z)((0,o.Z)({},t),{},{pendingPermissionsPreCheck:[...t.pendingPermissionsPreCheck,na([a,c])]});delete l.tplStateStoreId,delete l.forEachItem;var u=s[0].appId,[p,d]=yield Promise.all([To(c,u,l),Po(a,l)]),f=(0,o.Z)((0,o.Z)({title:yield Ro(p)},(0,i.pick)(p,["icon","link","defaultCollapsed","defaultCollapsedBreakpoint"])),{},{menuItems:d.filter(Ge).map((e=>{var t,r=null===(t=e.children)||void 0===t?void 0:t.filter(Ge);return"group"===e.type?{type:"group",title:e.text,items:r}:null!=r&&r.length?{type:"subMenu",title:e.text,icon:e.icon,items:r,defaultExpanded:e.defaultExpanded}:e}))});Lo.set(e,f)})),Uo.apply(this,arguments)}var jo=Symbol.for("pre.evaluated.raw"),Fo=Symbol.for("pre.evaluated.context");function $o(e){return!(null==e||!e[jo])}function Ko(e){return"string"==typeof e?(0,u.shouldAllowRecursiveEvaluations)(e):(0,u.shouldAllowRecursiveEvaluations)(e[jo])}var Do=new WeakSet([SyntaxError,TypeError,ReferenceError]);function Wo(e){return Do.has(e.constructor)?e.constructor:TypeError}function Vo(){return(Vo=(0,a.Z)((function*(e,t,r){var{blockingList:n,run:o}=Ho(e,t,r,!0);return yield Promise.all(n),o()}))).apply(this,arguments)}function Ho(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,a=[];if("string"!=typeof e){var c=(0,i.omit)(t,["pendingPermissionsPreCheck","tplStateStoreMap","tplStateStoreScope","formStateStoreMap","formStateStoreScope"]);t=(0,o.Z)((0,o.Z)({},e[Fo]),c),e=e[jo]}var l,d={usedArgs:new Set},h={usedArgs:new Set};try{l=(0,u.preevaluate)(e,{withParent:!0,hooks:{beforeVisitGlobal(e,t){An(d,e,t),On(h,e,t)}}})}catch(t){var m="".concat(t.message,', in "').concat(e,'"');throw new(Wo(t))(m)}if(d.hasNonStaticUsage)throw new Error('Non-static usage of "APP.getMenu" is prohibited in v3, check your expression: "'.concat(e,'"'));if(h.hasNonStaticUsage)throw new Error('Non-static usage of "INSTALLED_APPS.has" is prohibited in v3, check your expression: "'.concat(e,'"'));var g,b,w,S,E={},{attemptToVisitGlobals:A}=l;if(r.lazy||A.has("EVENT")&&!(0,p.hasOwnProperty)(t,"event")||A.has("DATA")&&!(0,p.hasOwnProperty)(t,"data"))return{blockingList:a,run:()=>Object.keys(t).length>0?{[jo]:e,[Fo]:t}:e};var O,_,C=ot(t);(A.has("STATE")||!C&&A.has("TPL"))&&(S=lt(t,"STATE",': "'.concat(e,'"'))),A.has("FORM_STATE")&&(_=pt(t,"FORM_STATE",': "'.concat(e,'"')));var R,M=I();if(n||M){if(A.has("CTX")&&(g=(0,s.strictCollectMemberUsage)(e,"CTX"),n&&a.push(t.ctxStore.waitFor(g))),S){if(w=(0,s.strictCollectMemberUsage)(e,"STATE"),!C){var x=(0,s.strictCollectMemberUsage)(e,"TPL");for(var B of x)w.add(B)}n&&a.push(S.waitFor(w))}_&&(O=(0,s.strictCollectMemberUsage)(e,"FORM_STATE"),n&&a.push(_.waitFor(O))),A.has("PROCESSORS")&&(b=(0,s.strictCollectMemberUsage)(e,"PROCESSORS",2),n&&a.push((0,f.loadProcessorsImperatively)(b,uo())))}if(n){var L=A.has("PERMISSIONS");if(!L&&A.has("FN")){var N=[...(0,s.strictCollectMemberUsage)(e,"FN")];L=Q(N)}if(L&&a.push(...t.pendingPermissionsPreCheck),d.usedArgs.size>0){var U=[...d.usedArgs];a.push(Promise.all(U.map((e=>function(e,t){var r=Bo.get(e);return r||(r=function(e,t){return Uo.apply(this,arguments)}(e,t)),r}(e,t)))))}h.usedArgs.size>0&&a.push((R=[...h.usedArgs],Promise.all(R.map((e=>Tn.get(e))))))}return{blockingList:a,run(){var r,n,{app:a,location:s,query:c,match:d,flags:f,sys:h,ctxStore:m,data:I,event:R}=t,M=null!==(r=t.overrideApp)&&void 0!==r?r:a;for(var x of A)switch(x){case"ANCHOR":E[x]=s.hash?s.hash.substring(1):null;break;case"APP":E[x]=(0,o.Z)((0,o.Z)({},(0,i.cloneDeep)(M)),{},{getMenu:No});break;case"CTX":E[x]=P({get:(e,t)=>m.getValue(t),ownKeys:()=>Array.from(g)});break;case"DATA":E[x]=I;break;case"EVENT":E[x]=R;break;case"FLAGS":E[x]=T(f);break;case"FORM_STATE":E[x]=P({get:(e,t)=>_.getValue(t),ownKeys:()=>Array.from(O)});break;case"HASH":E[x]=s.hash;break;case"INSTALLED_APPS":E[x]=T({has:_n});break;case"ITEM":(0,p.hasOwnProperty)(t,"forEachItem")?E[x]=t.forEachItem:console.error('Using `ITEM` but no `:forEach` is found, check your expression: "'.concat(e,'"'));break;case"LOCAL_STORAGE":E[x]=T({getItem:ce("local")});break;case"MEDIA":E[x]=T(se());break;case"MISC":E[x]=io().getMiscSettings();break;case"PARAMS":E[x]=new URLSearchParams(c);break;case"PATH":E[x]=T(null!==(n=null==d?void 0:d.params)&&void 0!==n?n:{});break;case"PATH_NAME":E[x]=s.pathname;break;case"PROCESSORS":E[x]=P({get(e,t){var r=y.get(t);if(!r)throw new Error("'PROCESSORS.".concat(t,"' is not registered! Have you installed the relevant brick package?"));return P({get:(e,t)=>r.get(t),ownKeys:()=>Array.from(r.keys())})},ownKeys:()=>Array.from(b)});break;case"QUERY":E[x]=Object.fromEntries(Array.from(c.keys()).map((e=>[e,c.get(e)])));break;case"QUERY_ARRAY":E[x]=Object.fromEntries(Array.from(c.keys()).map((e=>[e,c.getAll(e)])));break;case"SESSION_STORAGE":E[x]=T({getItem:ce("session")});break;case"TPL":if(at(C,'Using "TPL" in expression','check your expression: "'.concat(e,'"')),C)break;case"STATE":E[x]=P({get:(e,t)=>S.getValue(t),ownKeys:()=>Array.from(w)});break;case"SYS":E[x]=T(null!=h?h:{});break;case"__WIDGET_FN__":E[x]=go;break;case"__WIDGET_IMG__":E[x]=Z;break;case"__WIDGET_I18N__":E[x]=k}Object.assign(E,V(l.attemptToVisitGlobals,{storyboardFunctions:J,app:t.app,appendI18nNamespace:t.appendI18nNamespace}));try{return(0,u.cook)(l.expression,l.source,{globalVariables:(0,v.supply)(l.attemptToVisitGlobals,E)})}catch(t){var B="".concat(t.message,', in "').concat(e,'"');throw new(Wo(t))(B)}}}}function qo(e,t){return Go.apply(this,arguments)}function Go(){return Go=(0,a.Z)((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=$o(e);if(n||"string"==typeof e){var o,a=r.$$lazyForUseBrick&&Qe(r.$$stateOfUseBrick),i=a;return n||(0,u.isEvaluable)(e)?(o=yield function(e,t,r){return Vo.apply(this,arguments)}(e,t,{lazy:a}),i=Ko(e)):o=a?e:((0,p.hasOwnProperty)(t,"data")?r.noInject?d.transform:d.transformAndInject:r.noInject?Yo:d.inject)(e,t),i||ln(o),o}if(!(0,p.isObject)(e)||un(e))return e;if(Array.isArray(e)){var s=Jo(r,!0);return Promise.all(e.map((e=>qo(e,t,s))))}return Object.fromEntries((yield Promise.all(Object.entries(e).map((e=>{var[n,o]=e;return Promise.all([qo(n,t),qo(o,t,Jo(r,!1,n))])})))).concat(r.ignoreSymbols?[]:Object.getOwnPropertySymbols(e).map((t=>[t,e[t]]))))})),Go.apply(this,arguments)}function zo(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=$o(e);if(n||"string"==typeof e){var o,a=r.$$lazyForUseBrick&&Qe(r.$$stateOfUseBrick),i=a;return n||(0,u.isEvaluable)(e)?(o=function(e,t,r){var{run:n}=Ho(e,t,void 0,!1);return n()}(e,t),i=Ko(e)):o=a?e:((0,p.hasOwnProperty)(t,"data")?r.noInject?d.transform:d.transformAndInject:r.noInject?Yo:d.inject)(e,t),i||ln(o),o}if(!(0,p.isObject)(e)||un(e))return e;if(Array.isArray(e)){var s=Jo(r,!0);return e.map((e=>zo(e,t,s)))}return Object.fromEntries(Object.entries(e).map((e=>{var[n,o]=e;return[zo(n,t),zo(o,t,Jo(r,!1,n))]})).concat(r.ignoreSymbols?[]:Object.getOwnPropertySymbols(e).map((t=>[t,e[t]]))))}function Jo(e,t,r){return e.$$lazyForUseBrick?(0,o.Z)((0,o.Z)({},e),{},{$$stateOfUseBrick:Xe(e.$$stateOfUseBrick,t,r)}):e}function Yo(e){return e}var Qo=[],Xo=new Map;function ea(e){if(pa()&&!la().isAdmin)return oa((0,s.scanPermissionActionsInStoryboard)(e))}function ta(e,t){return ra.apply(this,arguments)}function ra(){return(ra=(0,a.Z)((function*(e,t){if(pa()&&!la().isAdmin&&Array.isArray(e.permissionsPreCheck))return oa(yield qo(e.permissionsPreCheck,t))}))).apply(this,arguments)}function na(e){if(pa()&&!la().isAdmin)return oa((0,s.scanPermissionActionsInAny)(e))}function oa(e){return aa.apply(this,arguments)}function aa(){return(aa=(0,a.Z)((function*(e){var t=(0,i.difference)(e,[...Qo]);if(0!==t.length){Qo.push(...t);try{var r=yield l({actions:t});for(var n of r.actions)Xo.set(n.action,n.authorizationStatus),"undefined"===n.authorizationStatus&&console.error('Undefined permission action: "'.concat(n.action,'"'))}catch(e){console.error("Pre-check permissions failed",e)}}}))).apply(this,arguments)}function ia(){if(!pa())return!1;if(la().isAdmin)return!0;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n of t)switch(Xo.get(n)){case"unauthorized":case"undefined":return!1;case void 0:return console.error('Un-checked permission action: "'.concat(n,'", please make sure the permission to check is defined in permissionsPreCheck.')),!1}return!0}var sa={};function ca(e){Object.assign(sa,{org:e.org,username:e.username,userInstanceId:e.userInstanceId,loginFrom:e.loginFrom,accessRule:e.accessRule,isAdmin:e.isAdmin,csrfToken:e.csrfToken,license:e.license,userShowValue:e.userShowValue})}function la(){return(0,o.Z)({},sa)}function ua(){for(var e of Object.keys(sa))sa[e]=void 0;Qo.length=0,Xo.clear()}function pa(){return void 0!==sa.username}function da(e,t,r){return fa.apply(this,arguments)}function fa(){return(fa=(0,a.Z)((function*(e,t,r){return De(yield Ue(e),e,"resolve",t,r)}))).apply(this,arguments)}function va(e){var t,{portal:r,scope:n="fragment",unknownBricks:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r;t=r||(()=>((i=document.createElement("div")).style.position="absolute",i.style.width=i.style.height="0",document.body.append(i),i));var s,c,l=!1;return{render(r){var u=arguments;return(0,a.Z)((function*(){var{theme:a,context:p,functions:d,templates:v,i18n:h}=u.length>1&&void 0!==u[1]?u[1]:{};if(l)throw new Error("The root is unmounted and cannot be rendered any more");var m=[].concat(r),g={ctxStore:new sr("CTX"),pendingPermissionsPreCheck:[],tplStateStoreMap:new Map},y=s;s=new Jr(n,{unknownBricks:o});var b={tag:gr.ROOT,container:e,createPortal:t};if("page"===n){var S,E={id:"demo",homepage:"/demo"};g.app=E;var k={app:E,meta:{i18n:h,customTemplates:v}};null===(S=c)||void 0===S||S(),c=w(k),pn(k),Y(d,E)}g.ctxStore.define(p,g);var Z,I=!1;try{Z=yield Ar(b,m,g,s),(0,f.flushStableLoadBricks)(),yield Promise.all([...Z.blockingList,g.ctxStore.waitForAll(),...[...g.tplStateStoreMap.values()].map((e=>e.waitForAll())),...g.pendingPermissionsPreCheck])}catch(e){I=!0,Z={node:{tag:gr.BRICK,type:"div",properties:{textContent:Mt(e)},return:b,runtimeContext:null},blockingList:[],menuRequests:[]}}b.child=Z.node,null==y||y.dispatchOnUnmount(),null==y||y.dispose(),Nr(e),i&&Nr(i),"page"===n&&(M(null!=a?a:"light"),F("default"),I||s.dispatchBeforePageLoad(),L(),K()),Ur(b),"page"===n&&window.scrollTo(0,0),I||("page"===n&&s.dispatchPageLoad(),s.dispatchOnMount(),s.initializeScrollIntoView(),s.initializeMediaChange())}))()},unmount(){l||(l=!0,Nr(e),i&&(Nr(i),r||i.remove()))}}}function ha(e,t){return ma.apply(this,arguments)}function ma(){return(ma=(0,a.Z)((function*(e,t){var r,n,a,i=[],s=[],c=(0,o.Z)((0,o.Z)({},fo()),{},{data:t,pendingPermissionsPreCheck:[],tplStateStoreScope:i,formStateStoreScope:s});null!==(r=c.tplStateStoreMap)&&void 0!==r||(c.tplStateStoreMap=new Map),null!==(n=c.formStateStoreMap)&&void 0!==n||(c.formStateStoreMap=new Map);var l=new Jr("fragment"),u={tag:gr.ROOT,createPortal:null},p=e.transform,d=ot();p&&at(d,"`useBrick.transform`",'please use "properties" instead, check your useBrick:',e);var v=yield Tr(u,d?e:(0,o.Z)((0,o.Z)({},e),{},{properties:(0,o.Z)((0,o.Z)({},e.properties),p)}),c,l);if((0,f.flushStableLoadBricks)(),yield Promise.all([...v.blockingList,...[...i,...s].map((e=>e.waitForAll())),...c.pendingPermissionsPreCheck]),null!==(a=v.node)&&void 0!==a&&a.portal)throw new Error("The root brick of useBrick cannot be a portal brick");return u.child=v.node,{tagName:v.node?v.node.type:null,renderRoot:u,rendererContext:l}}))).apply(this,arguments)}function ga(e,t){var r,{renderRoot:n,rendererContext:o}=e;return n.createPortal=()=>{var e=document.querySelector("#portal-mount-point");return r=document.createElement("div"),e.appendChild(r),r},Ur(n,t),o.dispatchOnMount(),o.initializeScrollIntoView(),o.initializeMediaChange(),{portal:r}}function ya(e,t){var{rendererContext:r}=e;t.portal&&(Nr(t.portal),t.portal.remove()),r.dispatchOnUnmount(),r.dispose()}function ba(e,t,r){if(r)throw new Error("Legacy doTransform does not support options in v3");return zo(t,(0,o.Z)((0,o.Z)({},fo()),{},{data:e}),{noInject:!0})}function wa(e,t){var r=vo(e);Object.assign(r,(0,o.Z)((0,o.Z)({},t),{},{$$fulfilling:null,$$fulfilled:!0,$$registerCustomTemplateProcessed:!1})),w(r)}function Sa(e,t){var r=vo(e),n=!1,o=e=>"".concat(e.path,".").concat(e.exact),a=(e,r)=>e.map((e=>{var i=o(e);return"routes"===e.type?(e.routes=a(e.routes,r),e):i===r?(n=!0,t):e}));r.routes=a(r.routes,o(t)),n||r.routes.unshift(t)}function Ea(e,t,r){var n="".concat(e,".").concat(t.name);ct.define(n,{bricks:t.bricks,proxy:t.proxy,state:t.state}),ka(e,t.name,r)}function ka(e,t,r){Aa(e,"${APP.homepage}/_dev_only_/template-preview/".concat(t),[(0,o.Z)({brick:t},(0,i.pick)(r,"properties","events","lifeCycle","context"))])}function Za(e,t){var r;Aa(e,"${APP.homepage}/_dev_only_/snippet-preview/".concat(t.snippetId),null!==(r=t.bricks)&&void 0!==r&&r.length?t.bricks:[{brick:"span"}])}var Ia=Za;function Aa(e,t,r){var{routes:n}=vo(e),o=n.findIndex((e=>e.path===t)),a={path:t,bricks:r,menu:!1,exact:!0};-1===o?n.unshift(a):n.splice(o,1,a)}}}]);
//# sourceMappingURL=9598.22e5360b.js.map